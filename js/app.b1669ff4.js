(function(){"use strict";var e={9374:function(e,t,a){var n=a(3751),r=a(641);function s(e,t,a,n,s,i){const l=(0,r.g2)("router-link"),o=(0,r.g2)("router-view"),c=(0,r.g2)("el-container");return(0,r.uX)(),(0,r.Wv)(c,null,{default:(0,r.k6)((()=>[(0,r.bF)(l,{to:"/page2",class:"tab-link","active-class":"active"},{default:(0,r.k6)((()=>[(0,r.eW)("11")])),_:1}),(0,r.bF)(c,null,{default:(0,r.k6)((()=>[(0,r.bF)(o)])),_:1})])),_:1})}var i=a(9644),l={components:{ElContainer:i.lX},data(){return{sidebarVisible:!0}},methods:{toggleSidebar(){this.sidebarVisible=!this.sidebarVisible}}},o=a(6262);const c=(0,o.A)(l,[["render",s]]);var d=c,u=a(5220);const m=(0,r.Lk)("h1",null,"Recreate Figure 1",-1),p=(0,r.Lk)("div",{id:"page1"},[(0,r.Lk)("div",{id:"chart"})],-1);function h(e,t,a,n,s,i){const l=(0,r.g2)("el-header"),o=(0,r.g2)("el-main"),c=(0,r.g2)("el-container");return(0,r.uX)(),(0,r.Wv)(c,null,{default:(0,r.k6)((()=>[(0,r.bF)(l,null,{default:(0,r.k6)((()=>[m])),_:1}),(0,r.bF)(o,null,{default:(0,r.k6)((()=>[p])),_:1})])),_:1})}function g(e){console.log("Row Data:",e)}a(6573),a(8100),a(7936),a(7467),a(4732),a(9577);var y=a(3959);async function v(){const e=await fetch("/Open Bank Transaction Data.xlsx"),t=await e.arrayBuffer(),a=new Uint8Array(t),n=y.LF(a,{type:"array"}),r=n.SheetNames[1],s=n.Sheets[r],i=y.Wp.sheet_to_json(s);return{jsonData:i,worksheet:s}}var f={name:"Page1",components:{ElContainer:i.lX,ElHeader:i.bZ,ElMain:i.ZO},setup(){(0,r.sV)((async()=>{const{jsonData:e}=await v();g(e)}))}};const b=(0,o.A)(f,[["render",h]]);var A=b;const k=e=>((0,r.Qi)("data-v-3cd2b8f4"),e=e(),(0,r.jt)(),e),w={class:"switch-fixed"},x={class:"radio-container"},D={class:"el-dropdown-link"},C={style:{width:"100px"}},S={key:0,class:"mapping-legend"},F={key:1,class:"average-info"},q={key:0,class:"new-content-container"},L={id:"algorithm-process"},M={key:1,class:"new-content-container"},_={key:2,class:"new-content-container"},E={key:3,class:"new-content-container"},T={key:4,class:"new-content-container"},$={id:"user-option"},O=k((()=>(0,r.Lk)("span",{class:"custom-inactive-action"},"☀️",-1))),I=k((()=>(0,r.Lk)("span",{class:"custom-active-action"},"🌙",-1))),W={class:"radio-group"},H={class:"algorithm_box"},j={style:{"margin-top":"10px"}},K={id:"similar-list"},R={id:"algorithm-details"},V=["innerHTML"];function X(e,t,a,n,s,i){const l=(0,r.g2)("el-tree"),o=(0,r.g2)("el-switch"),c=(0,r.g2)("el-radio"),d=(0,r.g2)("el-radio-group"),u=(0,r.g2)("arrow-down"),m=(0,r.g2)("el-icon"),p=(0,r.g2)("el-dropdown-item"),h=(0,r.g2)("el-dropdown-menu"),g=(0,r.g2)("el-dropdown"),y=(0,r.g2)("el-scrollbar"),v=(0,r.g2)("el-anchor-link"),f=(0,r.g2)("el-anchor"),b=(0,r.g2)("el-col"),A=(0,r.g2)("algorithm-process"),k=(0,r.g2)("AverageDay"),X=(0,r.g2)("CategoryDistribution"),B=(0,r.g2)("AmountDistribution"),z=(0,r.g2)("TimeDistribution"),P=(0,r.g2)("el-main"),Y=(0,r.g2)("el-option"),N=(0,r.g2)("el-select"),U=(0,r.g2)("el-button"),Q=(0,r.g2)("k-means"),G=(0,r.g2)("top-similar-list"),J=(0,r.g2)("transaction-similarity"),Z=(0,r.g2)("el-container");return(0,r.uX)(),(0,r.Wv)(Z,{direction:"vertical"},{default:(0,r.k6)((()=>[(0,r.bF)(P,{class:"up-half-page"},{default:(0,r.k6)((()=>[(0,r.bF)(l,{ref:"legendTree",class:"custom-tree",data:n.legendData,"show-checkbox":"","node-key":"id","default-expand-all":"",props:n.defaultProps,onCheck:n.handleCheck,"render-content":n.renderContent},null,8,["data","props","onCheck","render-content"]),(0,r.bF)(y,{ref:"containerRef"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",{id:"event-sequence",style:{"overflow-y":"auto"},onClick:t[0]||(t[0]=(...e)=>n.showDetail&&n.showDetail(...e))}),(0,r.Lk)("div",w,[(0,r.bF)(o,{modelValue:n.showAllDates,"onUpdate:modelValue":t[1]||(t[1]=e=>n.showAllDates=e),class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"All Dates","inactive-text":"Less Dates"},null,8,["modelValue"]),(0,r.Lk)("div",x,[(0,r.bF)(d,{modelValue:n.selectedMapping,"onUpdate:modelValue":t[2]||(t[2]=e=>n.selectedMapping=e),class:"radio-group-vertical"},{default:(0,r.k6)((()=>[(0,r.bF)(c,{value:"none"},{default:(0,r.k6)((()=>[(0,r.eW)("No Amount Mapping")])),_:1}),(0,r.bF)(c,{value:"height"},{default:(0,r.k6)((()=>[(0,r.eW)("Amount Map to Height")])),_:1}),(0,r.bF)(c,{value:"width"},{default:(0,r.k6)((()=>[(0,r.eW)("Amount Map to Width")])),_:1}),(0,r.bF)(c,{value:"area"},{default:(0,r.k6)((()=>[(0,r.eW)("Amount Map to Area")])),_:1})])),_:1},8,["modelValue"])]),(0,r.bF)(g,{onCommand:i.handleDropdownCommand,style:{"margin-top":"10px"}},{dropdown:(0,r.k6)((()=>[(0,r.bF)(h,null,{default:(0,r.k6)((()=>[(0,r.bF)(p,{command:"mostFrequent"},{default:(0,r.k6)((()=>[(0,r.eW)("Most frequent day")])),_:1}),(0,r.bF)(p,{command:"averageDay"},{default:(0,r.k6)((()=>[(0,r.eW)("Average day info")])),_:1}),(0,r.bF)(p,{command:"categoryDistribution"},{default:(0,r.k6)((()=>[(0,r.eW)("Category distribution")])),_:1}),(0,r.bF)(p,{command:"amountDistribution"},{default:(0,r.k6)((()=>[(0,r.eW)("Amount distribution")])),_:1}),(0,r.bF)(p,{command:"timeDistribution"},{default:(0,r.k6)((()=>[(0,r.eW)("Time distribution")])),_:1})])),_:1})])),default:(0,r.k6)((()=>[(0,r.Lk)("span",D,[(0,r.eW)(" Find Average Day "),(0,r.bF)(m,{class:"el-icon--right"},{default:(0,r.k6)((()=>[(0,r.bF)(u)])),_:1})])])),_:1},8,["onCommand"])])])),_:1},512),(0,r.Lk)("div",C,[(0,r.bF)(b,{span:6},{default:(0,r.k6)((()=>[(0,r.bF)(f,{container:n.containerRef,direction:"vertical",type:"default",offset:30,onClick:n.handleYearClick,style:{width:"100px"}},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Object.keys(n.yearPositions).reverse(),(e=>((0,r.uX)(),(0,r.Wv)(v,{key:e,href:`#year-${e}`,title:`Year ${e}`},null,8,["href","title"])))),128))])),_:1},8,["container","onClick"])])),_:1})]),n.showMappingLegend?((0,r.uX)(),(0,r.CE)("div",S)):((0,r.uX)(),(0,r.CE)("div",F,["mostFrequent"===n.selectedDropdown?((0,r.uX)(),(0,r.CE)("div",q,[(0,r.Lk)("div",L,[(0,r.bF)(A,{details:n.selectedDetails,similarDetails:n.selectedSimilarDetails,dailySequences:n.dailySequences,dailyAmounts:n.dailyAmounts,selectedMapping:n.selectedMapping},null,8,["details","similarDetails","dailySequences","dailyAmounts","selectedMapping"])])])):(0,r.Q3)("",!0),"averageDay"===n.selectedDropdown?((0,r.uX)(),(0,r.CE)("div",M,[(0,r.bF)(k,{parsedData:n.parsedData},null,8,["parsedData"])])):(0,r.Q3)("",!0),"categoryDistribution"===n.selectedDropdown&&n.jsonData&&n.worksheet?((0,r.uX)(),(0,r.CE)("div",_,[(0,r.bF)(X,{data:n.jsonData},null,8,["data"])])):(0,r.Q3)("",!0),"amountDistribution"===n.selectedDropdown&&n.jsonData&&n.worksheet?((0,r.uX)(),(0,r.CE)("div",E,[(0,r.bF)(B,{data:n.jsonData},null,8,["data"])])):(0,r.Q3)("",!0),"timeDistribution"===n.selectedDropdown&&n.jsonData&&n.worksheet?((0,r.uX)(),(0,r.CE)("div",T,[(0,r.bF)(z,{parsedData:n.parsedData,selectedCategories:n.selectedCategories},null,8,["parsedData","selectedCategories"])])):(0,r.Q3)("",!0)]))])),_:1}),(0,r.bF)(P,{class:"down-half-page"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",$,[(0,r.Lk)("div",null,[(0,r.bF)(o,{modelValue:n.isDarkMode,"onUpdate:modelValue":t[3]||(t[3]=e=>n.isDarkMode=e),class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#DDDEE0","--el-switch-off-color":"#606266"},"active-text":"Light","inactive-text":"Dark"},{"active-action":(0,r.k6)((()=>[O])),"inactive-action":(0,r.k6)((()=>[I])),_:1},8,["modelValue"])]),(0,r.Lk)("div",W,[(0,r.bF)(d,{modelValue:n.selectedOption,"onUpdate:modelValue":t[4]||(t[4]=e=>n.selectedOption=e),class:"radio-group-vertical"},{default:(0,r.k6)((()=>[(0,r.bF)(c,{value:"category"},{default:(0,r.k6)((()=>[(0,r.eW)("Category Similarity")])),_:1}),(0,r.bF)(c,{value:"amount"},{default:(0,r.k6)((()=>[(0,r.eW)("Amount Similarity")])),_:1}),(0,r.bF)(c,{value:"combined"},{default:(0,r.k6)((()=>[(0,r.eW)("Category & Amount Similarity")])),_:1})])),_:1},8,["modelValue"])]),(0,r.Lk)("div",H,[(0,r.bF)(N,{modelValue:n.selectedAlgorithm,"onUpdate:modelValue":t[5]||(t[5]=e=>n.selectedAlgorithm=e),placeholder:"Select Algorithm",disabled:"amount"==n.selectedOption},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{label:"Levenshtein",value:"levenshtein"}),(0,r.bF)(Y,{label:"Damerau-Levenshtein",value:"damerau-levenshtein"}),(0,r.bF)(Y,{label:"Hamming",value:"hamming"}),(0,r.bF)(Y,{label:"Jaro-Winkler",value:"jaro-winkler"})])),_:1},8,["modelValue","disabled"])]),(0,r.Lk)("div",j,[(0,r.bF)(U,{onClick:i.toggleTransactionDetail,style:{width:"100px"}},{default:(0,r.k6)((()=>[(0,r.eW)("Calendar")])),_:1},8,["onClick"])]),(0,r.bF)(U,{onClick:i.openKMeansDrawer,style:{width:"100px"}},{default:(0,r.k6)((()=>[(0,r.eW)("Cluster")])),_:1},8,["onClick"]),(0,r.bF)(Q,{parsedData:n.parsedData,isDarkMode:n.isDarkMode,ref:"kmeansComponent"},null,8,["parsedData","isDarkMode"])]),(0,r.Lk)("div",K,[(0,r.bF)(G,{topSimilarSequences:n.topSimilarSequences,selectedDetails:n.selectedDetails,listAmounts:n.listAmounts,selectedMapping:n.selectedMapping,selectedOption:n.selectedOption,onSelectSimilarSequence:n.handleSelectSimilarSequence},null,8,["topSimilarSequences","selectedDetails","listAmounts","selectedMapping","selectedOption","onSelectSimilarSequence"])]),(0,r.Lk)("div",R,["category"===n.selectedOption?((0,r.uX)(),(0,r.CE)("div",{key:0,id:"algorithm-description",innerHTML:n.selectedDescription},null,8,V)):(0,r.Q3)("",!0)])])),_:1}),(0,r.bF)(J,{visible:n.showTransactionDetail,details:n.selectedDetails,dailySequences:n.dailySequences,dailyAmounts:n.dailyAmounts,algorithm:n.selectedAlgorithm,selectedOption:n.selectedOption,onClose:i.closeDetail,onUpdateTopSimilarSequences:n.handleUpdateTopSimilarSequences},null,8,["visible","details","dailySequences","dailyAmounts","algorithm","selectedOption","onClose","onUpdateTopSimilarSequences"])])),_:1})}a(3375),a(9225),a(3972),a(9209),a(5714),a(7561),a(6197);var B=a(8682),z=a(953),P=(a(4114),a(9716));const Y="#B8ECB8",N="#8CDC8C",U="#5CC45C",Q="#39A939",G="#1F911F",J="#0A730A",Z="#005500",ee="#003400",te="#F5F573",ae="#D3D347",ne="#B5B526",re="#8F8F0D",se="#FFE1A4",ie="#FFCF70",le="#FFAA00",oe="#D99100",ce="#A76F00",de="#FFC6C6",ue="#FFA3A3",me="#F57373",pe="#D34747",he="#B52626",ge="#8F0D0D",ye="#6A0000",ve="#BB80DC",fe="#843AAD",be="#85A0DD",Ae="#5F7EC6",ke="#4061AD",we="#264A9C",xe={Groceries:Y,Entertainment:N,Amazon:U,"Dine Out":Q,Travel:G,Fitness:J,"Food Shopping":Z,Clothes:ee,Savings:te,Bills:ae,Cash:ne,"Account transfer":re,"Home Improvement":se,Hotels:ie,"Services/Home Improvement":le,Mortgage:oe,Rent:ce,Investment:de,"Supplementary Income":ue,"Travel Reimbursement":me,"Safety Deposit Return":pe,Interest:he,Paycheck:ge,"Purchase of uk.eg.org":ye,Insurance:ve,Health:fe,Others:be,Null:Ae,Services:ke,"Other Shopping":we},De={A:Y,B:N,C:U,D:Q,E:G,F:J,G:Z,H:ee,I:te,J:ae,K:ne,L:re,M:se,N:ie,O:le,P:oe,Q:ce,R:de,S:ue,T:me,U:pe,V:he,W:ge,X:ye,Y:ve,Z:fe,1:be,2:Ae,3:ke,4:we},Ce={Groceries:"A",Entertainment:"B",Amazon:"C","Dine Out":"D",Travel:"E",Fitness:"F","Food Shopping":"G",Clothes:"H",Savings:"I",Bills:"J",Cash:"K","Account transfer":"L","Home Improvement":"M",Hotels:"N","Services/Home Improvement":"O",Mortgage:"P",Rent:"Q",Investment:"R","Supplementary Income":"S","Travel Reimbursement":"T","Safety Deposit Return":"U",Interest:"V",Paycheck:"W","Purchase of uk.eg.org":"X",Insurance:"Y",Health:"Z",Others:"1",Null:"2",Services:"3","Other Shopping":"4"},Se=Object.fromEntries(Object.entries(Ce).map((([e,t])=>[t,e]))),Fe=[5,15,25,35,45,55,65,75,85,95,105,115,125,135,145,155,165,175,185,195,205,215,225,235,245,255,265,275,285,295,305,315,325,335,345,355,365,375,385,395,405,415,425,435,445,455],qe=[1,10,50,100,200,300,400,500,600,700,800,900,1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3,5500,6e3,6500,7e3,7500,8e3,8500,9e3,9500,1e4,15e3,2e4,25e3,3e4,35e3,4e4,45e3,5e4,55e3,6e4,65e3,7e4,75e3,8e4,85e3];function Le(e){return e.forEach((e=>{const t=e.debitAmount+e.creditAmount,a=qe.findIndex((e=>t<=e));e.mappedHeight=-1!==a?Fe[a]:Fe[Fe.length-1]})),e}const Me=[5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,195,200,205,210,215,220,225,230],_e=[1,10,50,100,200,300,400,500,600,700,800,900,1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3,5500,6e3,6500,7e3,7500,8e3,8500,9e3,9500,1e4,15e3,2e4,25e3,3e4,35e3,4e4,45e3,5e4,55e3,6e4,65e3,7e4,75e3,8e4,85e3];function Ee(e){return e.forEach((e=>{const t=e.debitAmount+e.creditAmount,a=_e.findIndex((e=>t<=e));e.mappedWidth=-1!==a?Me[a]:Me[Me.length-1]})),e}const Te=[50,100,200,300,400,500,600,700,800,900,1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3,5500,6e3,6500,7e3,7500,8e3,8500,9e3,9500,1e4,10500,11e3,12e3,13e3,14e3,15e3,16e3,17e3,18e3,19e3,2e4,21e3,22e3,23e3,24e3,25e3,26e3],$e=[1,10,50,100,200,300,400,500,600,700,800,900,1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3,5500,6e3,6500,7e3,7500,8e3,8500,9e3,9500,1e4,15e3,2e4,25e3,3e4,35e3,4e4,45e3,5e4,55e3,6e4,65e3,7e4,75e3,8e4,85e3];function Oe(e){return e.forEach((e=>{const t=e.debitAmount+e.creditAmount,a=$e.findIndex((e=>t<=e)),n=-1!==a?Te[a]:Te[Te.length-1];e.mappedHeight=Math.sqrt(n),e.mappedWidth=Math.sqrt(n)})),e}function Ie(e,t,a=!1,n=new Set,r="none"){let s=e.map(((e,a)=>{let n,r=`B${a+2}`,s=t[r],i=e["Transaction Date"];if(s&&"n"===s.t){const e=new Date(86400*(s.v-25569)*1e3);let t=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getDate().toString().padStart(2,"0"),r=e.getFullYear();n=`${r}-${a}-${t}`}else if(s&&"mm/dd/yyyy"===s.z){let e=i.split("/");if(3===e.length){let t=e[0].padStart(2,"0"),a=e[1].padStart(2,"0"),r=e[2];n=`${r}-${t}-${a}`}else n=i}else{i=i.toString();let e=i.split("/");if(3===e.length){let t=e[0].padStart(2,"0"),a=e[1].padStart(2,"0"),r=e[2];n=`${r}-${a}-${t}`}else n=i}const l=e["Category"]?e["Category"].trim():"Null",o=e["subCategory"]?e["subCategory"].trim():"Null",c=e["Debit Amount"]?e["Debit Amount"]:0,d=e["Credit Amount"]?e["Credit Amount"]:0,u=e["Transaction Number"]?e["Transaction Number"]:0;return{date:n,category:l,subCategory:o,debitAmount:c,creditAmount:d,transactionNumber:u}})).filter((e=>e.date));"height"===r?s=Le(s):"width"===r?s=Ee(s):"area"===r&&(s=Oe(s));const i=B.Os0(s,(e=>e.date)),l=Array.from(i.keys()).sort(((e,t)=>new Date(t)-new Date(e))),o=new Date(l[l.length-1]),c=new Date(l[0]);let d=[];for(let F=new Date(o);F<=c;F.setDate(F.getDate()+1))d.push(new Date(F).toISOString().split("T")[0]);d.push(c.toISOString().split("T")[0]),d.sort(((e,t)=>new Date(t)-new Date(e)));const u=Array.from(new Set(s.map((e=>e.subCategory)))).sort(((e,t)=>e.localeCompare(t))),m=B.UMr().domain(u).range(u.map((e=>xe[e]||"#000000")));function p(){B.Ubm(".event-rect").style("opacity",(e=>n.has(e.subCategory)?1:.1))}B.Ltv("#event-sequence-header .legend-container").remove();const h={top:20,right:320,bottom:20,left:200},g=20,y=15;let v=a?d:Array.from(i.keys());const f=Math.max((v.length+300)*(g+25)+h.top+h.bottom,800),b=(0,P.A)().attr("class","d3-tip").offset([-10,0]).html((e=>{let t=`\n      <span>Date:</span> <span>${e.date}</span><br>\n      <span>Category:</span> <span>${e.category}</span><br>\n      <span>SubCategory:</span> <span>${e.subCategory}</span><br>\n    `;return 0!==e.debitAmount&&(t+=`<span>Debit Amount:</span> <span>${e.debitAmount}</span><br>`),0!==e.creditAmount&&(t+=`<span>Credit Amount:</span> <span>${e.creditAmount}</span>`),t}));B.Ltv("#event-sequence svg").remove();const A=B.Ltv("#event-sequence").append("svg").attr("width",750).attr("height",f).append("g").attr("transform",`translate(${h.left},${h.top})`).call(b);let k=0;const w=new Set(i.keys()),x={},D={};let C=null;const S={};return v.forEach((e=>{const t=new Date(e).getFullYear();t!==C&&(0!=k&&(k+=g),A.append("g").attr("transform",`translate(0, ${k})`).append("text").attr("class","year-label").attr("id",`year-${t}`).attr("x",-135).attr("y",g/2).attr("dy","0.35em").attr("text-anchor","start").text(`${t}`),S[t]=k,C=t,k+=g);const a=new Date(e).toLocaleDateString("en-US",{weekday:"long"}).substring(0,2),n=i.get(e)||[],s=("height"===r||"area"===r)&&B.T9B(n,(e=>e.mappedHeight))||g,l="height"===r||"area"===r?s+2:g,o=A.append("g").attr("transform",`translate(0, ${k})`);if(w.has(e)){n.sort(((e,t)=>t.transactionNumber-e.transactionNumber));let t=n.map((e=>{const t=Ce[e.subCategory]||"0";return`${t}`})).join("");x[e]=t,D[e]={debitAmounts:n.map((e=>e.debitAmount)),creditAmounts:n.map((e=>e.creditAmount))},o.selectAll("rect").data(n).enter().append("rect").attr("x",((e,t)=>{if("width"===r||"area"===r){const e=n.slice(0,t).map((e=>e.mappedWidth||y));return e.reduce(((e,t)=>e+t),-80)}return t*y-80})).attr("y",(e=>"height"===r?s-e.mappedHeight:"area"===r?(s-e.mappedHeight)/2:0)).attr("width",(e=>"width"===r||"area"===r?e.mappedWidth:y)).attr("height",(e=>"height"===r||"area"===r?e.mappedHeight:g-2)).attr("class","event-rect").attr("fill",(e=>m(e.subCategory))).on("mouseover",(function(e,t){b.show(t,this)})).on("mouseout",(function(e,t){b.hide(t,this)}))}const c="height"===r?s:"area"===r?s/2:g/2;o.append("text").attr("class","text-style").attr("x",-135).attr("y",c).attr("dy","height"===r?null:"0.35em").attr("text-anchor","start").text(e.slice(5)),o.append("rect").attr("x",-185).attr("y",c-10).attr("width",60).attr("height",20).attr("fill","none"),o.append("text").attr("class","text-style").attr("x",-160).attr("y",c).attr("dy","height"===r?null:"0.35em").attr("text-anchor","middle").text(a),k+=l})),p(),B.Ltv("#select-all").on("click",(()=>{n=new Set(u),p()})),B.Ltv("#clear-all").on("click",(()=>{n=new Set,p()})),{dailySequences:x,dailyAmounts:D,yearPositions:S,parsedData:s}}function We(e){const t=330,a=455,n={top:40,right:20,bottom:60,left:80},r=B.Ltv(e).append("svg").attr("width",t+n.left+n.right).attr("height",a+n.top+n.bottom).append("g").attr("transform",`translate(${n.left},${n.top})`),s=5,i=Math.ceil(Fe.length/s),l=Array.from({length:s},((e,t)=>({heights:Fe.slice(t*i,(t+1)*i),segments:qe.slice(t*i,(t+1)*i),indices:Array.from({length:i},((e,t)=>t+1))}))),o=B.WH().domain(l[0].indices).range([0,t]).padding(.1),c=B.m4Y().domain([0,B.T9B(Fe)]).range([a,0]),d=B.l78(o).tickFormat((()=>"")),u=B.V4s(c);r.append("g").attr("class","y-axis").call(u),r.append("text").attr("class","y-axis-title").attr("x",-n.left/2).attr("y",-20).style("text-anchor","start").style("font-size","12px").text("Mapping height (unit: px)");const m=r.append("g").attr("class","x-axis").attr("transform",`translate(0,${a})`).call(d);r.append("text").attr("class","x-axis-title").attr("x",t/2).attr("y",a+n.bottom-20).style("text-anchor","middle").style("font-size","12px").text("Transaction amount (unit: BGP)"),l.reverse().forEach(((e,t)=>{r.selectAll(`.bar-layer-${t}`).data(e.heights).enter().append("rect").attr("class",`bar-layer-${t}`).attr("x",((e,t)=>o(t+1))).attr("y",(e=>c(e))).attr("width",o.bandwidth()).attr("height",(e=>a-c(e))).attr("fill",(()=>{switch(t){case 0:return"#8F5E0D";case 1:return"#B57F26";case 2:return"#D39E47";case 3:return"#F5C473";case 4:return"#FFDCA3";default:return"#cccccc"}})).attr("opacity",1).on("mouseover",(function(){r.selectAll("rect").attr("opacity",0),B.Ubm(`.bar-layer-${t}`).attr("opacity",1),d.tickFormat(((e,a)=>{const n=(s-t-1)*i+a;return n<qe.length?`${qe[n]}`:""})),m.call(d)})).on("mouseout",(function(){r.selectAll("rect").attr("opacity",1),d.tickFormat((()=>"")),m.call(d)})),r.selectAll(`.label-layer-${t}`).data(e.heights).enter().append("text").attr("class",`label-layer-${t}`).attr("x",((e,t)=>o(t+1)+o.bandwidth()/2)).attr("y",(e=>c(e)-10)).attr("dy",".75em").text(((e,a)=>{const n=(s-t-1)*i+a;return n<qe.length?qe[n]:""})).style("text-anchor","middle").style("font-size","10px").on("mouseover",(function(){r.selectAll("rect").attr("opacity",0),B.Ubm(`.bar-layer-${t}`).attr("opacity",1),d.tickFormat(((e,a)=>{const n=(s-t-1)*i+a;return n<qe.length?`${qe[n]}`:""})),m.call(d)})).on("mouseout",(function(){r.selectAll("rect").attr("opacity",1),d.tickFormat((()=>"")),m.call(d)}))}))}function He(e){const t=230,a=300,n={top:50,right:20,bottom:50,left:70},r=B.Ltv(e).append("svg").attr("width",t+n.left+n.right).attr("height",a+n.top+n.bottom).append("g").attr("transform",`translate(${n.left},${n.top})`),s=5,i=Math.ceil(Me.length/s),l=Array.from({length:s},((e,t)=>({widths:Me.slice(t*i,(t+1)*i),segments:_e.slice(t*i,(t+1)*i),indices:Array.from({length:i},((e,t)=>t+1))}))),o=B.m4Y().domain([0,B.T9B(Me)]).range([0,t]),c=B.WH().domain(l[0].indices).range([0,a]).padding(.1),d=B.l78(o),u=B.V4s(c).tickFormat((()=>""));r.append("g").attr("class","x-axis").attr("transform",`translate(0,${a})`).call(d);const m=r.append("g").attr("class","y-axis").call(u);l.reverse().forEach(((e,t)=>{r.selectAll(`.bar-layer-${t}`).data(e.widths).enter().append("rect").attr("class",`bar-layer-${t}`).attr("x",0).attr("y",((e,t)=>c(t+1))).attr("width",(e=>o(e))).attr("height",c.bandwidth()).attr("fill",(()=>{switch(t){case 0:return"#8F5E0D";case 1:return"#B57F26";case 2:return"#D39E47";case 3:return"#F5C473";case 4:return"#FFDCA3";default:return"#cccccc"}})).attr("opacity",1).on("mouseover",(function(){r.selectAll("rect").attr("opacity",0),B.Ubm(`.bar-layer-${t}`).attr("opacity",1),u.tickFormat(((e,a)=>{const n=(s-t-1)*i+a;return n<_e.length?`${_e[n]}`:""})),m.call(u)})).on("mouseout",(function(){r.selectAll("rect").attr("opacity",1),u.tickFormat((()=>"")),m.call(u)})),r.selectAll(`.label-layer-${t}`).data(e.widths).enter().append("text").attr("class",`label-layer-${t}`).attr("x",(e=>o(e)+5)).attr("y",((e,t)=>c(t+1)+c.bandwidth()/2)).attr("dy",".35em").text(((e,a)=>{const n=(s-t-1)*i+a;return n<_e.length?_e[n]:""})).style("text-anchor","start").style("font-size","10px").on("mouseover",(function(){r.selectAll("rect").attr("opacity",0),B.Ubm(`.bar-layer-${t}`).attr("opacity",1),u.tickFormat(((e,a)=>{const n=(s-t-1)*i+a;return n<_e.length?`${_e[n]}`:""})),m.call(u)})).on("mouseout",(function(){r.selectAll("rect").attr("opacity",1),u.tickFormat((()=>"")),m.call(u)}))})),r.append("text").attr("class","x-axis-title").attr("x",t/2).attr("y",a+n.bottom-10).style("text-anchor","middle").style("font-size","12px").text("Mapping width (unit: px)"),r.append("text").attr("class","y-axis-title").attr("x",-50).attr("y",-n.left/2+15).style("text-anchor","letf").style("font-size","12px").text("Transaction amount (unit: BGP)")}function je(e){const t=340,a=400,n={top:40,right:0,bottom:50,left:60},r=B.Ltv(e).append("svg").attr("width",t+n.left+n.right).attr("height",a+n.top+n.bottom).append("g").attr("transform",`translate(${n.left},${n.top})`),s=B.m4Y().domain([0,t]).range([0,t]),i=B.m4Y().domain([0,a]).range([a,0]),l=B.l78(s).ticks(5).tickFormat((e=>`${e}`)),o=B.V4s(i).ticks(5).tickFormat((e=>`${e}`));r.append("g").attr("class","x-axis").attr("transform",`translate(0,${a})`).call(l),r.append("g").attr("class","y-axis").call(o),r.append("text").attr("x",t/2).attr("y",a+n.bottom-10).attr("text-anchor","middle").style("font-size","14px").text("Width (px)"),r.append("text").attr("x",-a/2).attr("y",20-n.left).attr("transform","rotate(-90)").attr("text-anchor","middle").style("font-size","14px").text("Height (px)");const c=Te.filter(((e,t)=>t%3===0)),d=$e.filter(((e,t)=>t%3===0)),u=c.map(((e,t)=>({size:e,segment:d[t],side:Math.sqrt(e)})));u.sort(((e,t)=>t.side-e.side));let m=0,p=0;const h=20;u.forEach(((e,n)=>{n>0&&(m+=h,p+=h),m+e.side>t&&(m=0,p+=h+e.side),p+e.side>a&&(p=0);const s=r.append("g").attr("transform",`translate(${m}, ${a-p-e.side})`);s.append("rect").attr("width",e.side).attr("height",e.side).attr("fill","#8F5E0D").attr("opacity",.9).on("mouseover",(function(){r.selectAll("rect").attr("opacity",.2),B.Ltv(this).attr("opacity",1),s.select("text").attr("opacity",1)})).on("mouseout",(function(){r.selectAll("rect").attr("opacity",.9),s.select("text").attr("opacity",0)})),s.append("text").attr("x",e.side/2).attr("y",e.side/2).attr("dy",".35em").text(`Amount <= ${e.segment}`).style("text-anchor","middle").style("font-size","10px").style("fill","white").attr("opacity",0)}))}const Ke={key:0,class:"transaction-detail"},Re={class:"header"};function Ve(e,t,a,n,s,i){const l=(0,r.g2)("el-button"),o=(0,r.g2)("month-view"),c=(0,r.g2)("el-backtop"),d=(0,r.g2)("el-tab-pane"),u=(0,r.g2)("year-view"),m=(0,r.g2)("el-tabs");return a.visible?((0,r.uX)(),(0,r.CE)("div",Ke,[(0,r.bF)(m,{type:"border-card",class:"custom-tabs"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",Re,[(0,r.bF)(l,{onClick:n.close,class:"close-button"},{default:(0,r.k6)((()=>[(0,r.eW)("Close")])),_:1},8,["onClick"])]),(0,r.bF)(d,{label:"Month View",class:"text-style"},{default:(0,r.k6)((()=>[(0,r.bF)(o,{highlightDates:n.similarDates,topSimilarSequences:n.topSimilarSequences,selectedOption:a.selectedOption},null,8,["highlightDates","topSimilarSequences","selectedOption"]),(0,r.bF)(c,{right:100,bottom:100,target:".custom-tabs"})])),_:1}),(0,r.bF)(d,{label:"Year View",class:"text-style"},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.years,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e,class:"year-container"},[(0,r.bF)(u,{year:e,"highlight-dates":n.similarDates},null,8,["year","highlight-dates"])])))),128)),(0,r.bF)(c,{right:100,bottom:100,target:".custom-tabs"})])),_:1})])),_:1})])):(0,r.Q3)("",!0)}var Xe=a(6796),Be=a(1857),ze=a(1058);function Pe(e,t,a,n){const r=e.value||e,s=t.value||t;let i=0,l=null;const o=Object.keys(r),c=o.length;for(let d=0;d<c;d++){const e=o[d],u=r[e];if(!u||"string"!==typeof u)continue;let m=0;for(let t=0;t<c;t++){if(d===t)continue;const i=o[t],l=r[i];if(!l||"string"!==typeof l)continue;let c;if("category"===a)c="jaro-winkler"===n?Je(u,l):Ze(u,l,n),c>=75&&m++;else if("amount"===a){const t=s[e],a=s[i],n=Ge(t,a),r=10;n<=r&&m++}}m>i&&(i=m,l={date:e,sequence:u,similarCount:m,debitAmounts:t[e]?.debitAmounts||[],creditAmounts:t[e]?.creditAmounts||[]})}return l?console.log("Most Similar Sequence:",l,"Similar Sequence Count",i):console.log("No similar sequences found."),l}function Ye(e,t){if(!e||!t)return 1/0;const a=[];for(let n=0;n<=t.length;n++)a[n]=[n];for(let n=0;n<=e.length;n++)a[0][n]=n;for(let n=1;n<=t.length;n++)for(let r=1;r<=e.length;r++)t.charAt(n-1)===e.charAt(r-1)?a[n][r]=a[n-1][r-1]:a[n][r]=Math.min(a[n-1][r-1]+1,a[n][r-1]+1,a[n-1][r]+1);return a[t.length][e.length]}function Ne(e,t){if(!e||!t)return 1/0;const a=[];for(let n=0;n<=t.length;n++)a[n]=[n];for(let n=0;n<=e.length;n++)a[0][n]=n;for(let n=1;n<=t.length;n++)for(let r=1;r<=e.length;r++)t.charAt(n-1)===e.charAt(r-1)?a[n][r]=a[n-1][r-1]:a[n][r]=Math.min(a[n-1][r-1]+1,a[n][r-1]+1,a[n-1][r]+1),n>1&&r>1&&t.charAt(n-1)===e.charAt(r-2)&&t.charAt(n-2)===e.charAt(r-1)&&(a[n][r]=Math.min(a[n][r],a[n-2][r-2]+1));return a[t.length][e.length]}function Ue(e,t){if(e.length!==t.length)return 1/0;let a=0;for(let n=0;n<e.length;n++)e.charAt(n)!==t.charAt(n)&&a++;return a}function Qe(e,t){if(!e||!t)return 1/0;if(e===t)return 0;const a=e.length,n=t.length,r=Math.floor(Math.max(a,n)/2)-1,s=Array(a).fill(!1),i=Array(n).fill(!1);let l=0;for(let p=0;p<a;p++){const a=Math.max(0,p-r),o=Math.min(p+r+1,n);for(let n=a;n<o;n++)if(!i[n]&&e.charAt(p)===t.charAt(n)){s[p]=!0,i[n]=!0,l++;break}}if(0===l)return 1;let o=0,c=0;for(let p=0;p<a;p++)if(s[p]){while(!i[c])c++;e.charAt(p)!==t.charAt(c)&&o++,c++}o/=2;const d=(l/a+l/n+(l-o)/l)/3,u=e.split("").findIndex(((e,a)=>e!==t.charAt(a)))||0,m=.1;return 1-(d+Math.min(u,4)*m*(1-d))}function Ge(e,t){const a=e.creditAmounts.map(((t,a)=>t+e.debitAmounts[a])),n=t.creditAmounts.map(((e,a)=>e+t.debitAmounts[a])),[r,s]=a.length>=n.length?[a,n]:[n,a],i=r.length-s.length,l=[];for(let d=0;d<i;d++){let e=-1,t=1/0;for(let a=0;a<r.length;a++)!l.includes(a)&&r[a]<t&&(t=r[a],e=a);l.push(e)}const o=[...s];l.forEach((e=>{o.splice(e,0,0)}));const c=Math.sqrt(r.reduce(((e,t,a)=>e+Math.pow(t-o[a],2)),0));return c}function Je(e,t){return 100*(1-Qe(e,t))}function Ze(e,t,a){if(!e||!t)return 0;let n;if("levenshtein"===a)n=Ye(e,t);else if("damerau-levenshtein"===a)n=Ne(e,t);else{if("hamming"!==a)throw new Error(`Unknown algorithm: ${a}`);n=Ue(e,t)}const r=e.length;return 100*(1-n/r)}function et(e,t,a="levenshtein",n=10){const r=t.map((t=>{const n="jaro-winkler"===a?Je(e,t.sequence):Ze(e,t.sequence,a);return{date:t.date,sequence:t.sequence,similarity:n}}));return r.sort(((e,t)=>t.similarity-e.similarity)),r.slice(0,n)}function tt(e,t,a=10){const n=t.map((t=>{const a=Ge({creditAmounts:t.creditAmounts,debitAmounts:t.debitAmounts},{creditAmounts:e.creditAmounts,debitAmounts:e.debitAmounts});return{date:t.date,sequence:t.sequence,similarity:a}}));return n.sort(((e,t)=>e.similarity-t.similarity)),n.slice(0,a)}function at(e,t,a="levenshtein",n=10){const r=t.map((t=>{const n="jaro-winkler"===a?Je(e.sequence,t.sequence):Ze(e.sequence,t.sequence,a),r=Ge({creditAmounts:t.creditAmounts,debitAmounts:t.debitAmounts},{creditAmounts:e.creditAmounts,debitAmounts:e.debitAmounts}),s=Math.log1p(r),i=s/(1+s),l=1-i,o=(n+l)/2;return{date:t.date,sequence:t.sequence,categorySimilarity:n,amountSimilarity:l,combinedSimilarity:o}}));return r.sort(((e,t)=>t.combinedSimilarity-e.combinedSimilarity)),r.slice(0,n)}var nt=a(33);const rt={class:"year-view"},st={class:"year-header"},it={class:"year-grid"},lt={class:"month-header"},ot={class:"days-grid"};function ct(e,t,a,n,s,i){return(0,r.uX)(),(0,r.CE)("div",rt,[(0,r.Lk)("div",st,(0,nt.v_)(a.year),1),(0,r.Lk)("div",it,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.months,(e=>((0,r.uX)(),(0,r.CE)("div",{class:"month",key:e.name},[(0,r.Lk)("div",lt,(0,nt.v_)(e.name),1),(0,r.Lk)("div",ot,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.dayNames,(e=>((0,r.uX)(),(0,r.CE)("div",{class:"day-name",key:e},(0,nt.v_)(e),1)))),128)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.days,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.date,class:(0,nt.C4)(["day",{highlight:a.highlightDates.includes(e.date)}])},(0,nt.v_)(e.number),3)))),128))])])))),128))])])}var dt={name:"YearView",props:{year:{type:Number,required:!0},highlightDates:{type:Array,required:!0}},data(){return{months:[{name:"January",days:[]},{name:"February",days:[]},{name:"March",days:[]},{name:"April",days:[]},{name:"May",days:[]},{name:"June",days:[]},{name:"July",days:[]},{name:"August",days:[]},{name:"September",days:[]},{name:"October",days:[]},{name:"November",days:[]},{name:"December",days:[]}],dayNames:["S","M","T","W","T","F","S"]}},watch:{year:"generateCalendar"},mounted(){this.generateCalendar()},methods:{generateCalendar(){const e=this.year;this.months.forEach(((t,a)=>{const n=new Date(Date.UTC(e,a+1,0)).getDate(),r=new Date(Date.UTC(e,a,1)).getDay();t.days=[];for(let e=0;e<r;e++)t.days.push({date:null,number:""});for(let s=1;s<=n;s++){const n=new Date(Date.UTC(e,a,s)).toISOString().split("T")[0];t.days.push({date:n,number:s})}}))}}};const ut=(0,o.A)(dt,[["render",ct],["__scopeId","data-v-4eca8988"]]);var mt=ut;const pt={class:"month-view"},ht={class:"month-calendars"},gt={class:"calendar-header"},yt={class:"days-grid"},vt={class:"day-content"},ft={key:0,class:"extra-content"};function bt(e,t,a,n,s,i){const l=(0,r.g2)("el-switch");return(0,r.uX)(),(0,r.CE)("div",pt,[(0,r.bF)(l,{modelValue:s.showOnlyHighlightedMonths,"onUpdate:modelValue":t[0]||(t[0]=e=>s.showOnlyHighlightedMonths=e),"active-text":"Show Only Highlighted Months","inactive-text":"Show All Months",class:"custom-switch"},null,8,["modelValue"]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.years,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e,class:"year-section"},[(0,r.Lk)("h2",null,(0,nt.v_)(e),1),(0,r.Lk)("div",ht,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.filteredMonths(e),(t=>((0,r.uX)(),(0,r.CE)("div",{key:t.index,class:"calendar-container"},[(0,r.Lk)("div",gt,(0,nt.v_)(t.name),1),(0,r.Lk)("div",yt,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.dayNames,(e=>((0,r.uX)(),(0,r.CE)("div",{class:"day-name",key:e},(0,nt.v_)(e),1)))),128)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.getDaysInMonth(e,t.index),(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.date,class:(0,nt.C4)(["day",{highlight:a.highlightDates.includes(e.date)}])},[(0,r.Lk)("div",vt,[(0,r.Lk)("span",null,(0,nt.v_)(e.number),1),a.highlightDates.includes(e.date)?((0,r.uX)(),(0,r.CE)("div",ft,(0,nt.v_)(i.getSimilarity(e.date))+"% ",1)):(0,r.Q3)("",!0)])],2)))),128))])])))),128))])])))),128))])}var At=a(8135),kt={name:"MonthView",components:{ElSwitch:At.qi},props:{highlightDates:{type:Array,required:!1,default:()=>[]},topSimilarSequences:{type:Array,required:!0},selectedOption:{type:String,required:!0}},data(){return{showOnlyHighlightedMonths:!1,years:Array.from({length:8},((e,t)=>2015+t)),months:[{name:"January",index:0},{name:"February",index:1},{name:"March",index:2},{name:"April",index:3},{name:"May",index:4},{name:"June",index:5},{name:"July",index:6},{name:"August",index:7},{name:"September",index:8},{name:"October",index:9},{name:"November",index:10},{name:"December",index:11}],dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}},methods:{getDaysInMonth(e,t){const a=new Date(e,t+1,0).getDate(),n=new Date(e,t,1).getDay(),r=[];for(let s=0;s<n;s++)r.push({date:null,number:"",extraContent:""});for(let s=1;s<=a;s++){const a=new Date(Date.UTC(e,t,s)).toISOString().split("T")[0];r.push({date:a,number:s,extraContent:""})}return r},getSimilarity(e){const t=this.topSimilarSequences.find((t=>t.date===e));return t?"combined"===this.selectedOption?`${t.combinedSimilarity.toFixed(2)}%`:t.similarity?t.similarity.toFixed(2):"":""},isMonthHighlighted(e,t){const a=this.getDaysInMonth(e,t);return a.some((e=>e.date&&this.highlightDates.includes(e.date)))},filteredMonths(e){return this.showOnlyHighlightedMonths?this.months.filter((t=>this.isMonthHighlighted(e,t.index))):this.months}}};const wt=(0,o.A)(kt,[["render",bt],["__scopeId","data-v-554f4f1e"]]);var xt=wt,Dt={name:"TransactionSimilarity",components:{ElTabs:Xe.q,ElTabPane:Xe.v$,ElButton:Be.S2,ElBacktop:ze.ax,YearView:mt,MonthView:xt},props:{visible:{type:Boolean,required:!0},details:{type:Object,required:!1},dailySequences:{type:Object,required:!0},dailyAmounts:{type:Object,required:!0},algorithm:{type:String,required:!0},selectedOption:{type:String,required:!0}},setup(e,{emit:t}){const a=(0,z.KR)(new Date),n=(0,z.KR)(new Date),s=(0,z.KR)([]),i=(0,z.KR)([]),l=(0,z.KR)([2015,2016,2017,2018,2019,2020,2021,2022]),o=e=>{const t=new Date(e),a=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0");return`${a}-${n}-${r}`},c=()=>{const e=document.querySelectorAll(".el-calendar-table__row .el-calendar-day span.highlight");e.forEach((e=>{e.classList.remove("highlight"),e.style.backgroundColor="",e.style.borderRadius="",e.style.fontWeight="",e.style.color="";const t=e.parentNode.querySelector(".similarity-text");t&&e.parentNode.removeChild(t)}))},d=()=>{(0,r.dY)((()=>{c();const e=i.value,t=document.querySelectorAll(".el-calendar-table__row .el-calendar-day"),n=a.value.getMonth(),r=a.value.getFullYear();t.forEach((t=>{const a=t.querySelector("span");if(!a)return;const i=a.textContent.trim(),l=new Date(r,n,parseInt(i)),c=o(l);if(e.includes(c)&&l.getMonth()===n){a.classList.add("highlight"),a.style.backgroundColor="#ffecb3",a.style.borderRadius="50%",a.style.fontWeight="bold",a.style.color="red";const e=s.value.find((e=>e.date===c)).similarity.toFixed(2),n=document.createElement("div");n.className="similarity-text",n.innerText=`${e}%`,n.style.fontSize="10px",n.style.color="blue",n.style.textAlign="center",n.style.position="absolute",n.style.bottom="2px",n.style.width="100%",n.style.pointerEvents="none",t.style.position="relative",t.appendChild(n)}}))}))},u=()=>{if(e.details&&e.details.date){const a=e.details.date,n=e.dailySequences[a];if(n){const r=e.dailyAmounts[a].debitAmounts.map(((t,n)=>t+e.dailyAmounts[a].creditAmounts[n])),l=Object.keys(e.dailySequences).map((t=>{const a=e.dailyAmounts[t].debitAmounts,n=e.dailyAmounts[t].creditAmounts,r=a.map(((e,t)=>e+n[t]));return{date:t,sequence:e.dailySequences[t],debitAmounts:a,creditAmounts:n,amountsSum:r}}));if("category"===e.selectedOption)s.value=et(n,l,e.algorithm);else if("amount"===e.selectedOption){const t={date:a,sequence:n,debitAmounts:e.dailyAmounts[a].debitAmounts,creditAmounts:e.dailyAmounts[a].creditAmounts,amountsSum:r};s.value=tt(t,l)}else if("combined"===e.selectedOption){const t={date:a,sequence:n,debitAmounts:e.dailyAmounts[a]?.debitAmounts||[],creditAmounts:e.dailyAmounts[a]?.creditAmounts||[]},r=l.map((e=>({...e,debitAmounts:e.debitAmounts||[],creditAmounts:e.creditAmounts||[]})));s.value=at(t,r,e.algorithm)}i.value=s.value.map((e=>e.date)),d(),t("update-top-similar-sequences",s.value)}}};(0,r.wB)((()=>e.details),u),(0,r.wB)((()=>e.algorithm),u),(0,r.wB)((()=>e.selectedOption),u);const m=()=>{t("close")};return{currentDate:a,selectedDate:n,topSimilarSequences:s,similarDates:i,close:m,years:l}}};const Ct=(0,o.A)(Dt,[["render",Ve],["__scopeId","data-v-8472bb5c"]]);var St=Ct;const Ft=e=>((0,r.Qi)("data-v-445e21ae"),e=e(),(0,r.jt)(),e),qt={class:"drawer-box"},Lt={class:"kmeans-content"},Mt=Ft((()=>(0,r.Lk)("h2",null,"K-means++ Cluster Analysis",-1))),_t={class:"input-container"},Et=Ft((()=>(0,r.Lk)("span",null,"Select Cluster Number:",-1))),Tt={style:{"margin-top":"20px"}},$t=Ft((()=>(0,r.Lk)("div",{id:"scatter-plot"},null,-1))),Ot=Ft((()=>(0,r.Lk)("div",{id:"bar-chart"},null,-1))),It=Ft((()=>(0,r.Lk)("div",{id:"elbow-chart"},null,-1)));function Wt(e,t,a,n,s,i){const l=(0,r.g2)("el-input-number"),o=(0,r.g2)("el-radio"),c=(0,r.g2)("el-radio-group"),d=(0,r.g2)("el-drawer");return(0,r.uX)(),(0,r.CE)("div",qt,[(0,r.bF)(d,{modelValue:e.visible,"onUpdate:modelValue":t[2]||(t[2]=t=>e.visible=t),size:"40%",direction:"rtl","with-header":!1,onClose:e.closeDrawer},{default:(0,r.k6)((()=>[(0,r.Lk)("div",Lt,[Mt,(0,r.Lk)("div",_t,[Et,(0,r.bF)(l,{modelValue:e.num,"onUpdate:modelValue":t[0]||(t[0]=t=>e.num=t),"controls-position":"right",min:1,max:10,"aria-label":"Number of Clusters",class:"custom-input"},null,8,["modelValue"])]),(0,r.Lk)("div",Tt,[(0,r.bF)(c,{modelValue:e.selectedOption,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selectedOption=t),onChange:e.initializeDrawer},{default:(0,r.k6)((()=>[(0,r.bF)(o,{value:"none"},{default:(0,r.k6)((()=>[(0,r.eW)("Normal")])),_:1}),(0,r.bF)(o,{value:"winsorize"},{default:(0,r.k6)((()=>[(0,r.eW)("Decrease Outlier (Cap at 5000)")])),_:1}),(0,r.bF)(o,{value:"logarithmic"},{default:(0,r.k6)((()=>[(0,r.eW)("Logarithmic")])),_:1})])),_:1},8,["modelValue","onChange"]),$t]),Ot,It])])),_:1},8,["modelValue","onClose"])])}var Ht=a(5013),jt=a(716),Kt=a(2012),Rt=a(27),Vt=(0,r.pM)({name:"KMeans",components:{ElDrawer:Ht.pw,ElInputNumber:jt.lq,ElRadioGroup:Kt.MQ,ElRadio:Kt.ll},props:{parsedData:{type:Array,required:!0},isDarkMode:{type:Boolean,required:!0}},setup(e){const t=(0,z.KR)(!1),a=(0,z.KR)(3),n=(0,z.KR)("logarithmic"),s=e=>{const t=new Date("2015-07-27"),a=new Date(e);return Math.floor((a-t)/864e5)},i=(e,t)=>e.map((e=>e>t?t:e)),l=e=>{const t=Math.min(...e),a=Math.max(...e);return e.map((e=>(e-t)/(a-t)))},o=()=>{u(e.isDarkMode);const t=e.parsedData.map((e=>s(e.date)));let r=e.parsedData.map((e=>e.debitAmount+e.creditAmount));const o=[...r];"winsorize"===n.value?r=i(r,5e3):"logarithmic"===n.value&&(r=r.map((e=>Math.log10(e+1))));const c=l(t),d=l(r),h=e.parsedData.map(((e,t)=>({originalDate:e.date,originalAmount:r[t],tooltipAmounts:o[t],date:c[t],amount:d[t]}))),g=h.map((e=>[e.date,e.amount])),y=(0,Rt.A)(g,a.value,{initialization:"kmeans++"}),v=h.map(((e,t)=>({...e,cluster:y.clusters[t]})));m(v);const f=(e,t=10)=>{const a=[];for(let n=1;n<=t;n++){const t=(0,Rt.A)(e,n),r=t.centroids.reduce(((a,n,r)=>{const s=Array.isArray(n)?n:Object.values(n)[0],i=e.filter(((e,a)=>t.clusters[a]===r)),l=i.reduce(((e,t)=>{const a=Math.sqrt(t.reduce(((e,t,a)=>e+Math.pow(t-s[a],2)),0));return e+Math.pow(a,2)}),0);return a+l}),0);a.push({k:n,sse:r})}return a},b=f(g);p(b)},c=()=>{t.value=!0,(0,r.dY)(o)},d=()=>{t.value=!1};(0,r.wB)(a,(()=>{t.value&&o()}));const u=e=>{const t=document.querySelector(".drawer-box .el-drawer__body");t&&(t.style.backgroundColor=e?"#ffffff":"#141414",t.style.color=e?"#141414":"#ffffff")},m=e=>{const t={top:50,right:10,bottom:40,left:65},a=500-t.left-t.right,r=400-t.top-t.bottom;B.Ltv("#scatter-plot").selectAll("*").remove();const s=B.Ltv("#scatter-plot").append("svg").attr("width",a+t.left+t.right).attr("height",r+t.top+t.bottom).append("g").attr("transform",`translate(${t.left},${t.top})`),i=B.w7C().domain(B.Xxv(e,(e=>new Date(e.originalDate)))).range([0,a]),l=B.T9B(e,(e=>e.originalAmount)),o=B.m4Y().domain([0,l]).range([r,0]);s.append("g").attr("transform",`translate(0,${r})`).call(B.l78(i).ticks(10).tickSizeOuter(0)),s.append("g").call(B.V4s(o).ticks(10).tickSizeOuter(0).tickValues([...o.ticks(10),l]).tickFormat("logarithmic"===n.value?e=>Math.pow(10,e)>1?Math.pow(10,e).toFixed(0):Math.pow(10,e).toPrecision(1):e=>e));const c=B.UMr(B.t55),d=(0,P.A)().attr("class","d3-tip").offset([-10,0]).html((function(e,t){return`<strong>Date:</strong> ${t.originalDate}<br>\n              <strong>Amount:</strong> ${t.tooltipAmounts}`}));s.call(d);const u=B.HRO().type(B.BVl).size(25);s.append("g").selectAll("path").data(e).enter().append("path").attr("d",u).attr("transform",(e=>`translate(${i(new Date(e.originalDate))}, ${o(e.originalAmount)})`)).style("fill",(e=>c(e.cluster))).style("opacity",.6).on("mouseover",d.show).on("mouseout",d.hide),s.append("text").attr("class","text-style").attr("x",a/2).attr("y",-10).attr("text-anchor","middle").style("font-size","16px").text("K-means Clustering Result"),s.append("rect").attr("class","stroke-style").attr("width",a).attr("height",r).attr("fill","none").attr("stroke-width",1),s.append("text").attr("class","text-style").attr("text-anchor","middle").attr("x",a/2).attr("y",r+t.bottom).attr("font-size","12px").text("Time"),s.append("text").attr("class","text-style").attr("transform","rotate(-90)").attr("text-anchor","middle").attr("x",-r/2).attr("y",10-t.left).attr("font-size","12px").text("Transaction Amount (unit: BGP)")},p=e=>{const t={top:70,right:10,bottom:40,left:65},a=500-t.left-t.right,n=330-t.top-t.bottom;B.Ltv("#elbow-chart").selectAll("*").remove();const r=B.Ltv("#elbow-chart").append("svg").attr("width",a+t.left+t.right).attr("height",n+t.top+t.bottom).append("g").attr("transform",`translate(${t.left},${t.top})`),s=B.m4Y().domain([1,B.T9B(e,(e=>e.k))]).range([0,a]),i=B.m4Y().domain([0,B.T9B(e,(e=>e.sse))]).range([n,0]),l=B.n8j().x((e=>s(e.k))).y((e=>i(e.sse)));r.append("path").datum(e).attr("class","line").attr("d",l).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",2),r.selectAll("dot").data(e).enter().append("circle").attr("cx",(e=>s(e.k))).attr("cy",(e=>i(e.sse))).attr("r",4).attr("fill","steelblue"),r.append("g").attr("transform",`translate(0,${n})`).call(B.l78(s).ticks(10)),r.append("g").call(B.V4s(i).ticks(10)),r.append("text").attr("class","text-style").attr("x",a/2).attr("y",n+t.bottom-10).attr("text-anchor","middle").style("font-size","12px").text("k"),r.append("text").attr("class","text-style").attr("transform","rotate(-90)").attr("x",-n/2).attr("y",10-t.left).attr("text-anchor","middle").style("font-size","12px").text("SSE"),r.append("text").attr("class","text-style").attr("x",a/2).attr("y",-20).attr("text-anchor","middle").style("font-size","16px").text("Elbow Method for Optimal K")};return(0,r.sV)((()=>{(0,r.dY)((()=>{e.parsedData.length>0&&c()}))})),(0,r.wB)((()=>e.isDarkMode),(e=>{u(e),t.value&&o()})),{visible:t,num:a,openDrawer:c,closeDrawer:d,selectedOption:n,initializeDrawer:o}}});const Xt=(0,o.A)(Vt,[["render",Wt],["__scopeId","data-v-445e21ae"]]);var Bt=Xt;const zt=e=>((0,r.Qi)("data-v-1d0bc642"),e=e(),(0,r.jt)(),e),Pt={key:0,class:"similar-sequences"},Yt={key:0,class:"selected-sequence"},Nt={class:"list-date"},Ut=["innerHTML"],Qt=zt((()=>(0,r.Lk)("span",{class:"list-text"},"(Target Sequence) ",-1))),Gt={class:"amount-sum"},Jt=["onClick"],Zt={class:"list-date"},ea=["innerHTML"],ta={class:"list-text"},aa={class:"amount-sum"};function na(e,t,a,n,s,i){return a.topSimilarSequences.length?((0,r.uX)(),(0,r.CE)("div",Pt,[(0,r.Lk)("ul",null,[(0,r.Lk)("li",null,[a.selectedDetails?((0,r.uX)(),(0,r.CE)("div",Yt,[(0,r.Lk)("span",{class:(0,nt.C4)(["day-of-week",i.getDayClass(i.getDayOfWeek(a.selectedDetails.date))])},(0,nt.v_)(i.getDayOfWeek(a.selectedDetails.date)),3),(0,r.Lk)("span",Nt,(0,nt.v_)(a.selectedDetails.date),1),(0,r.eW)(": "),(0,r.Lk)("span",{innerHTML:s.renderedSelectedSequence},null,8,Ut),Qt,(0,r.Lk)("span",Gt," Amounts: [ "+(0,nt.v_)(i.calculateAmountSum(a.selectedDetails.date))+" ] ",1)])):(0,r.Q3)("",!0)]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.filteredTopSimilarSequences,((e,t)=>((0,r.uX)(),(0,r.CE)("li",{key:t,onClick:t=>i.selectSimilarSequence(e)},[(0,r.Lk)("span",{class:(0,nt.C4)(["day-of-week",i.getDayClass(i.getDayOfWeek(e.date))])},(0,nt.v_)(i.getDayOfWeek(e.date)),3),(0,r.Lk)("span",Zt,(0,nt.v_)(e.date),1),(0,r.eW)(": "),(0,r.Lk)("span",{innerHTML:i.renderSequenceWithTooltip(e.sequence,e.date)},null,8,ea),(0,r.Lk)("span",ta,(0,nt.v_)(i.formattedSimilarityText(e)),1),(0,r.Lk)("span",aa," Amounts: [ "+(0,nt.v_)(i.calculateAmountSum(e.date))+" ] ",1)],8,Jt)))),128))])])):(0,r.Q3)("",!0)}var ra={name:"TopSimilarList",props:{topSimilarSequences:{type:Array,required:!0},selectedDetails:{type:Object,required:!0},listAmounts:{type:Object,required:!0},selectedMapping:{type:String,required:!0},selectedOption:{type:String,required:!0}},data(){return{renderedSelectedSequence:""}},mounted(){},watch:{selectedDetails(e){e&&e.date&&e.sequence&&(this.renderedSelectedSequence=this.renderSequenceWithTooltip(e.sequence,e.date))},selectedMapping(){this.renderedSelectedSequence=this.renderSequenceWithTooltip(this.selectedDetails.sequence,this.selectedDetails.date)}},computed:{filteredTopSimilarSequences(){return this.topSimilarSequences.filter((e=>e.date!==this.selectedDetails.date))}},methods:{renderSequenceWithTooltip(e,t){let a="";const n=this.listAmounts[t]?.debitAmounts||[],r=this.listAmounts[t]?.creditAmounts||[];let s=e.split("").map(((e,t)=>({char:e,debitAmount:n[t]||0,creditAmount:r[t]||0,subCategory:Se[e]||"Unknown"})));"height"===this.selectedMapping?s=Le(s):"width"===this.selectedMapping?s=Ee(s):"area"===this.selectedMapping&&(s=Oe(s));let i="baseline";return"none"!==this.selectedMapping&&"width"!==this.selectedMapping&&"area"!==this.selectedMapping||(i="middle"),s.forEach((e=>{const n=De[e.char]||"transparent";let r=`Date: ${t}, Char: ${e.char}, SubCategory: ${e.subCategory}`;0!==e.debitAmount&&(r+=`, Debit Amount: ${e.debitAmount}`),0!==e.creditAmount&&(r+=`, Credit Amount: ${e.creditAmount}`);const s=e.mappedWidth||15,l=e.mappedHeight||18;a+=`<span title="${r}" style="display: inline-block; width: ${s}px; height: ${l}px; background-color: ${n}; vertical-align: ${i};"></span>`})),a+=`<span style="margin-left: 15px; vertical-align: ${i};">${e}</span>`,a},getDayOfWeek(e){const t=["Su","Mo","Tu","We","Th","Fr","Sa"],a=new Date(e).getDay();return t[a]},getDayClass(e){const t={Mo:"monday",Tu:"tuesday",We:"wednesday",Th:"thursday",Fr:"friday",Sa:"saturday",Su:"sunday"};return t[e]||""},selectSimilarSequence(e){const t={date:e.date,sequence:e.sequence,debitAmounts:this.listAmounts[e.date]?.debitAmounts||[],creditAmounts:this.listAmounts[e.date]?.creditAmounts||[]};this.$emit("select-similar-sequence",t)},formattedSimilarityText(e){return"category"===this.selectedOption?`(Category Similarity: ${e.similarity.toFixed(2)}%)`:"amount"===this.selectedOption?`(Amount Distance: ${e.similarity.toFixed(2)})`:"combined"===this.selectedOption?`(Category Similarity: ${e.categorySimilarity.toFixed(2)}%, Amount Similarity: ${100*e.amountSimilarity.toFixed(2)}%, Combined Similarity: ${e.combinedSimilarity.toFixed(2)}%)`:""},calculateAmountSum(e){const t=this.listAmounts[e]?.debitAmounts||[],a=this.listAmounts[e]?.creditAmounts||[];return t.map(((e,t)=>e+a[t])).join(", ")}}};const sa=(0,o.A)(ra,[["render",na],["__scopeId","data-v-1d0bc642"]]);var ia=sa;const la=e=>((0,r.Qi)("data-v-77bb4eae"),e=e(),(0,r.jt)(),e),oa=la((()=>(0,r.Lk)("h3",null,"Most Frequent Consumption Mode (unit/day)",-1))),ca=la((()=>(0,r.Lk)("h4",null,"Based on Category (similarities above 90% are considered similar)",-1))),da=la((()=>(0,r.Lk)("strong",null,"Levenshtein Distance Algorithm:",-1))),ua={class:"sequence-container",id:"sequence-levenshtein"},ma=la((()=>(0,r.Lk)("span",null,"2022-07-07:",-1))),pa=la((()=>(0,r.Lk)("div",{id:"sequence-levenshtein-draw"},null,-1))),ha=la((()=>(0,r.Lk)("span",null,"(has 129 similar sequence)",-1))),ga=["innerHTML"],ya=la((()=>(0,r.Lk)("strong",null,"Damerau-Levenshtein Distance Algorithm:",-1))),va={class:"sequence-container",id:"sequence-damerau"},fa=la((()=>(0,r.Lk)("span",null,"2022-07-07:",-1))),ba=la((()=>(0,r.Lk)("div",{id:"sequence-damerau-draw"},null,-1))),Aa=la((()=>(0,r.Lk)("span",null,"(has 129 similar sequence)",-1))),ka=["innerHTML"],wa=la((()=>(0,r.Lk)("strong",null,"Hamming Distance Algorithm:",-1))),xa={class:"sequence-container",id:"sequence-hamming"},Da=la((()=>(0,r.Lk)("span",null,"2022-07-07:",-1))),Ca=la((()=>(0,r.Lk)("div",{id:"sequence-hamming-draw"},null,-1))),Sa=la((()=>(0,r.Lk)("span",null,"(has 129 similar sequence)",-1))),Fa=["innerHTML"],qa=la((()=>(0,r.Lk)("strong",null,"Jaro-Winkler Similarity Algorithm:",-1))),La={class:"sequence-container",id:"sequence-jaro"},Ma=la((()=>(0,r.Lk)("span",null,"2022-07-07:",-1))),_a=la((()=>(0,r.Lk)("div",{id:"sequence-jaro-draw"},null,-1))),Ea=la((()=>(0,r.Lk)("span",null,"(has 597 similar sequence)",-1))),Ta=["innerHTML"],$a=la((()=>(0,r.Lk)("h4",null,"Based on Amount (distance below 10 is considered similar)",-1))),Oa=la((()=>(0,r.Lk)("strong",null," Euclidean Distance Algorithm:",-1))),Ia={class:"sequence-container",id:"sequence-euclidean"},Wa=la((()=>(0,r.Lk)("span",null,"2019-12-05:",-1))),Ha=la((()=>(0,r.Lk)("div",{id:"sequence-euclidean-draw"},null,-1))),ja=la((()=>(0,r.Lk)("span",null,"(has 364 similar sequence)",-1))),Ka=["innerHTML"];function Ra(e,t,a,n,s,i){return(0,r.uX)(),(0,r.CE)("div",null,[oa,(0,r.Lk)("div",null,[ca,(0,r.Lk)("ul",null,[(0,r.Lk)("li",null,[da,(0,r.Lk)("div",ua,[ma,pa,ha,(0,r.Lk)("span",{innerHTML:i.displaySequenceInfo("2022-07-07")},null,8,ga)])]),(0,r.Lk)("li",null,[ya,(0,r.Lk)("div",va,[fa,ba,Aa,(0,r.Lk)("span",{innerHTML:i.displaySequenceInfo("2022-07-07")},null,8,ka)])]),(0,r.Lk)("li",null,[wa,(0,r.Lk)("div",xa,[Da,Ca,Sa,(0,r.Lk)("span",{innerHTML:i.displaySequenceInfo("2022-07-07")},null,8,Fa)])]),(0,r.Lk)("li",null,[qa,(0,r.Lk)("div",La,[Ma,_a,Ea,(0,r.Lk)("span",{innerHTML:i.displaySequenceInfo("2022-07-07")},null,8,Ta)])])])]),(0,r.Lk)("div",null,[$a,(0,r.Lk)("ul",null,[(0,r.Lk)("li",null,[Oa,(0,r.Lk)("div",Ia,[Wa,Ha,ja,(0,r.Lk)("span",{innerHTML:i.displaySequenceInfo("2019-12-05")},null,8,Ka)])])])])])}var Va={name:"AlgorithmProcess",props:{details:{type:Object,required:!0},similarDetails:{type:Object,required:!1},selectedMapping:{type:String,required:!0},dailySequences:Object,dailyAmounts:Object},mounted(){this.drawAllSequences()},updated(){this.drawAllSequences()},watch:{dailySequences(){this.drawAllSequences()},dailyAmounts(){this.drawAllSequences()},selectedMapping(){this.drawAllSequences()}},methods:{drawAllSequences(){this.renderSequence("2022-07-07","#sequence-levenshtein-draw"),this.renderSequence("2022-07-07","#sequence-damerau-draw"),this.renderSequence("2022-07-07","#sequence-hamming-draw"),this.renderSequence("2022-07-07","#sequence-jaro-draw"),this.renderSequence("2019-12-05","#sequence-euclidean-draw")},renderSequence(e,t){const a=this.dailySequences[e],n=this.dailyAmounts[e]?.debitAmounts||[],r=this.dailyAmounts[e]?.creditAmounts||[],s={date:e,sequence:a,debitAmounts:n,creditAmounts:r};this.drawSequence(a,t,s)},drawSequence(e,t,a){if(!e)return;B.Ltv(t).selectAll("*").remove(),B.Ltv("#similar-sequence-visualization").selectAll("*").remove();let n=e.split("").map(((e,t)=>({char:e,debitAmount:a.debitAmounts[t]||0,creditAmount:a.creditAmounts[t]||0,subCategory:Se[e]||"Unknown"})));"height"===this.selectedMapping?n=Le(n):"width"===this.selectedMapping?n=Ee(n):"area"===this.selectedMapping&&(n=Oe(n));const r=n.length*(n[0].mappedWidth||15),s="height"===this.selectedMapping?Math.max(...n.map((e=>e.mappedHeight))):18,i=B.Ltv(t).append("svg").attr("width",r).attr("height",s);i.selectAll("rect").data(n).enter().append("rect").attr("x",((e,t)=>t*(e.mappedWidth||15))).attr("y",0).attr("width",(e=>e.mappedWidth||15)).attr("height",(e=>e.mappedHeight||18)).attr("fill",(e=>this.getColor(e.char))).append("title").text((e=>{let t=`Date: ${a.date}, Char: ${e.char}, SubCategory: ${e.subCategory}`;return 0!==e.debitAmount&&(t+=`, Debit Amount: ${e.debitAmount}`),0!==e.creditAmount&&(t+=`, Credit Amount: ${e.creditAmount}`),t}))},displaySequenceInfo(e){const t=this.dailySequences[e],a=this.dailyAmounts[e]?.debitAmounts||[],n=this.dailyAmounts[e]?.creditAmounts||[],r=a.map(((e,t)=>e+(n[t]||0)));return`<span>${t}</span> <span style="margin-left: 10px;">Amounts: [${r.join(", ")}]</span>`},getColor(e){return De[e]||"transparent"},getDayOfWeek(e){const t=["Su","Mo","Tu","We","Th","Fr","Sa"],a=new Date(e).getDay();return t[a]},getDayClass(e){const t={Mo:"monday",Tu:"tuesday",We:"wednesday",Th:"thursday",Fr:"friday",Sa:"saturday",Su:"sunday"};return t[e]||""},getMostSimilarSequence(e,t){const a=Pe(this.dailySequences,this.dailyAmounts,e,t);return a?`date: ${a.date}, sequence: ${a.sequence}, number of similar sequence: ${a.similarCount}`:"did not find similar sequence"}}};const Xa=(0,o.A)(Va,[["render",Ra],["__scopeId","data-v-77bb4eae"]]);var Ba=Xa;const za=e=>((0,r.Qi)("data-v-58ada088"),e=e(),(0,r.jt)(),e),Pa={class:"category-distribution"},Ya=za((()=>(0,r.Lk)("div",{id:"category-distribution-chart"},null,-1))),Na=[Ya];function Ua(e,t,a,n,s,i){return(0,r.uX)(),(0,r.CE)("div",Pa,Na)}var Qa={name:"CategoryDistribution",props:{data:{type:Array,required:!0}},mounted(){this.drawHistogram(this.data)},methods:{drawHistogram(e){const t=B.Os0(e,(e=>e.Category)),a=Array.from(t.keys()).sort(((e,t)=>e.localeCompare(t))),n=[];a.forEach((e=>{const a=t.get(e),r=B.zaV(a,(e=>e.length),(e=>e.subCategory||"Null")),s=Array.from(r,(([t,a])=>({category:e,subCategory:t,count:a})));n.push(...s)}));const r={top:65,right:30,bottom:135,left:40},s=500-r.left-r.right,i=500-r.top-r.bottom,l=B.Ltv("#category-distribution-chart").append("svg").attr("width",s+r.left+r.right).attr("height",i+r.top+r.bottom).append("g").attr("transform",`translate(${r.left},${r.top})`),o=B.WH().domain(n.map((e=>e.subCategory))).range([0,s]).padding(.1);l.append("g").attr("transform",`translate(0,${i})`).call(B.l78(o)).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end");const c=B.m4Y().domain([0,B.T9B(n,(e=>e.count))]).nice().range([i,0]);l.append("g").call(B.V4s(c));const d=B.Ltv("body").append("div").attr("class","tooltip").style("position","absolute").style("visibility","hidden").style("background-color","white").style("border","solid 1px #ccc").style("padding","5px").style("border-radius","5px").style("font-size","12px");l.selectAll(".bar").data(n).enter().append("rect").attr("class","bar").attr("x",(e=>o(e.subCategory))).attr("y",(e=>c(e.count))).attr("width",o.bandwidth()).attr("height",(e=>i-c(e.count))).attr("fill",(e=>xe[e.subCategory]||"#ffffff")).on("mouseover",((e,t)=>{d.style("visibility","visible").html(`Category: ${t.category}<br>SubCategory: ${t.subCategory}<br>Count: ${t.count}`)})).on("mousemove",(e=>{const t=d.node().offsetWidth,a=window.innerWidth;let n=e.pageX+10;n+t>a&&(n=e.pageX-t-10),d.style("top",e.pageY-50+"px").style("left",`${n}px`)})).on("mouseout",(()=>{d.style("visibility","hidden")})),l.append("text").attr("class","y-axis-label").attr("text-anchor","start").attr("x",-r.left).attr("y",-20).attr("font-size","13px").text("Transaction number"),l.append("text").attr("x",s/2).attr("y",-r.top/2-20).attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").text("Category Distribution")}}};const Ga=(0,o.A)(Qa,[["render",Ua],["__scopeId","data-v-58ada088"]]);var Ja=Ga;const Za=e=>((0,r.Qi)("data-v-0187d981"),e=e(),(0,r.jt)(),e),en={class:"amount-distribution"},tn=Za((()=>(0,r.Lk)("div",{id:"amount-distribution-chart"},null,-1))),an=[tn];function nn(e,t,a,n,s,i){return(0,r.uX)(),(0,r.CE)("div",en,an)}var rn={name:"AmountDistribution",props:{data:{type:Array,required:!0}},mounted(){this.drawHistogram(this.data)},methods:{drawHistogram(e){const t={"Daily expenses and consumption":["Groceries","Entertainment","Amazon","Dine Out","Travel","Fitness","Food Shopping","Clothes"],"Financial management and transfers":["Savings","Bills","Cash","Account transfer"],"Housing and facilities":["Home Improvement","Hotels","Services/Home Improvement","Mortgage","Rent"],"Income and investments":["Investment","Supplementary Income","Travel Reimbursement","Safety Deposit Return","Interest","Paycheck","Purchase of uk.eg.org"],"Insurance and Health":["Insurance","Health"],"Other miscellaneous":["Others","Null","Services","Other Shopping"]},a=e.map((e=>({amount:(e["Debit Amount"]||0)+(e["Credit Amount"]||0),subCategory:e.subCategory||"Null",category:e.Category||"Unknown"}))),n=[{range:"0-1",min:0,max:1},{range:"1-5",min:1,max:5},{range:"5-10",min:5,max:10},{range:"10-20",min:10,max:20},{range:"20-50",min:20,max:50},{range:"50-100",min:50,max:100},{range:"100-500",min:100,max:500},{range:"500-1000",min:500,max:1e3},{range:"1000-5000",min:1e3,max:5e3},{range:"5000+",min:5e3,max:1/0}],r=n.map((e=>{const n=a.filter((t=>t.amount>e.min&&t.amount<=e.max)),r=B.zaV(n,(e=>e.length),(e=>e.subCategory)),s=Array.from(r,(([e,t])=>{const a=n.find((t=>t.subCategory===e))?.category||"Unknown";return{subCategory:e,count:t,category:a}})).sort(((e,a)=>e.category!==a.category?Object.keys(t).indexOf(a.category)-Object.keys(t).indexOf(e.category):t[e.category].indexOf(a.subCategory)-t[e.category].indexOf(e.subCategory)));return{range:e.range,subCategories:s,count:n.length}})),s={top:65,right:30,bottom:135,left:40},i=500-s.left-s.right,l=570-s.top-s.bottom,o=B.Ltv("#amount-distribution-chart").append("svg").attr("width",i+s.left+s.right).attr("height",l+s.top+s.bottom).append("g").attr("transform",`translate(${s.left},${s.top})`),c=B.WH().domain(r.map((e=>e.range))).range([0,i]).padding(.1);o.append("g").attr("transform",`translate(0,${l})`).call(B.l78(c)).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end");const d=B.m4Y().domain([0,B.T9B(r,(e=>e.count))]).nice().range([l,0]);o.append("g").call(B.V4s(d));const u=B.Ltv("body").append("div").attr("class","tooltip").style("position","absolute").style("visibility","hidden").style("background-color","white").style("border","solid 1px #ccc").style("padding","5px").style("border-radius","5px").style("font-size","12px");r.forEach((e=>{let t=0;e.subCategories.forEach((a=>{o.append("rect").attr("x",c(e.range)).attr("y",d(t+a.count)).attr("width",c.bandwidth()).attr("height",d(t)-d(t+a.count)).attr("fill",xe[a.subCategory]||"transparent").on("mouseover",(()=>{u.style("visibility","visible").html(`Category: ${a.category}<br>SubCategory: ${a.subCategory}<br>Count: ${a.count}`)})).on("mousemove",(e=>{const t=u.node().offsetWidth,a=window.innerWidth;let n=e.pageX+10;n+t>a&&(n=e.pageX-t-10),u.style("top",e.pageY-50+"px").style("left",`${n}px`)})).on("mouseout",(()=>{u.style("visibility","hidden")})),t+=a.count})),o.append("text").attr("x",c(e.range)+c.bandwidth()/2).attr("y",d(t)-5).attr("text-anchor","middle").attr("font-size","12px").text(e.count)})),o.append("text").attr("class","x-axis-label").attr("text-anchor","middle").attr("x",i/2).attr("y",l+s.bottom-80).attr("font-size","13px").text("Amount Range (unit: BGP)"),o.append("text").attr("class","y-axis-label").attr("text-anchor","start").attr("x",-s.left).attr("y",-15).attr("font-size","13px").text("Transaction Number"),o.append("text").attr("x",i/2).attr("y",-s.top/2-15).attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").text("Amount Distribution")}}};const sn=(0,o.A)(rn,[["render",nn],["__scopeId","data-v-0187d981"]]);var ln=sn;const on=e=>((0,r.Qi)("data-v-2d154a88"),e=e(),(0,r.jt)(),e),cn={style:{display:"flex","align-items":"center",height:"30px"}},dn=on((()=>(0,r.Lk)("p",{class:"text-style",style:{margin:"0 10px 0 0","font-size":"16px","line-height":"1.5"}},"Circle Size:",-1))),un=on((()=>(0,r.Lk)("div",{id:"time-distribution-chart"},null,-1)));function mn(e,t,a,n,s,i){const l=(0,r.g2)("el-input-number"),o=(0,r.g2)("el-radio"),c=(0,r.g2)("el-radio-group");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",cn,[dn,(0,r.bF)(l,{modelValue:s.circleRadius,"onUpdate:modelValue":t[0]||(t[0]=e=>s.circleRadius=e),min:1,max:10,"aria-label":"Circle Radius",step:.5,"controls-position":"right",size:"small",style:{width:"80px","line-height":"1.5"}},null,8,["modelValue"])]),(0,r.bF)(c,{modelValue:s.selectedYAxisOption,"onUpdate:modelValue":t[1]||(t[1]=e=>s.selectedYAxisOption=e)},{default:(0,r.k6)((()=>[(0,r.bF)(o,{value:"normal"},{default:(0,r.k6)((()=>[(0,r.eW)("Normal")])),_:1}),(0,r.bF)(o,{value:"winsorize"},{default:(0,r.k6)((()=>[(0,r.eW)("Decrease Outlier (Cap at 5000)")])),_:1}),(0,r.bF)(o,{value:"logarithmic"},{default:(0,r.k6)((()=>[(0,r.eW)("Logarithmic")])),_:1})])),_:1},8,["modelValue"]),un],64)}var pn={name:"TimeDistribution",components:{ElInputNumber:jt.lq,ElRadioGroup:Kt.MQ,ElRadio:Kt.ll},props:{parsedData:{type:Array,required:!0},selectedCategories:{type:Set,required:!0}},data(){return{circleRadius:3,selectedYAxisOption:"winsorize"}},mounted(){this.drawScatterPlot()},watch:{selectedCategories:{handler(){B.Ltv("#time-distribution-chart").selectAll("*").remove(),this.drawScatterPlot()},deep:!0},circleRadius(){B.Ltv("#time-distribution-chart").selectAll("*").remove(),this.drawScatterPlot()},selectedYAxisOption(){B.Ltv("#time-distribution-chart").selectAll("*").remove(),this.drawScatterPlot()}},methods:{drawScatterPlot(){const e={top:70,right:20,bottom:70,left:40},t=500-e.left-e.right,a=530-e.top-e.bottom;let n,r=5e3;"winsorize"===this.selectedYAxisOption?n=this.parsedData.map((e=>({...e,adjustedAmount:Math.min(e.debitAmount+e.creditAmount,5e3)}))):"logarithmic"===this.selectedYAxisOption?(n=this.parsedData.map((e=>({...e,adjustedAmount:Math.log10(e.debitAmount+e.creditAmount+1)}))),r=B.T9B(n,(e=>e.adjustedAmount))):(n=this.parsedData.map((e=>({...e,adjustedAmount:e.debitAmount+e.creditAmount}))),r=B.T9B(n,(e=>e.adjustedAmount)));const s=n.map((e=>new Date(e.date))),i=this.generateCustomTicks(s),l=B.Ltv("#time-distribution-chart").append("svg").attr("width",t+e.left+e.right).attr("height",a+e.top+e.bottom).append("g").attr("transform",`translate(${e.left},${e.top})`),o=B.w7C().domain([B.jkA(s),B.T9B(s)]).range([0,t]),c=B.l78(o).tickValues(i).tickFormat(B.DCK("%Y-%m-%d"));l.append("g").attr("transform",`translate(0,${a})`).call(c).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end");const d=B.m4Y().domain([0,r]).range([a,0]);l.append("g").call(B.V4s(d).ticks(10).tickFormat("logarithmic"===this.selectedYAxisOption?e=>Math.pow(10,e).toFixed(0):e=>e)),l.append("g").attr("transform",`translate(0, ${d(r)})`).call(B.V4s(d).tickValues([r]).tickFormat("logarithmic"===this.selectedYAxisOption?e=>Math.pow(10,e).toFixed(0):e=>e));const u=(0,P.A)().attr("class","d3-tip").offset([-10,0]).html((function(e,t){return`\n        <strong>Date:</strong> <span>${t.date}</span><br>\n        <strong>Amount:</strong> <span>${(t.debitAmount+t.creditAmount).toFixed(2)}</span><br>\n        <strong>Category:</strong> <span>${t.category}</span><br>\n        <strong>SubCategory:</strong> <span>${t.subCategory}</span>\n      `}));l.call(u),l.selectAll("circle").data(n).enter().append("circle").attr("cx",(e=>o(new Date(e.date)))).attr("cy",(e=>d(e.adjustedAmount))).attr("r",this.circleRadius).style("fill",(e=>xe[e.subCategory]||"transparent")).style("opacity",(e=>this.selectedCategories.has(e.subCategory)?1:0)).on("mouseover",u.show).on("mouseout",u.hide),l.append("text").attr("x",t/2).attr("y",-40).attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").text("Time Distribution of Transactions"),l.append("text").attr("class","y-axis-label").attr("text-anchor","start").attr("x",-e.left).attr("y",-15).attr("font-size","13px").text("logarithmic"===this.selectedYAxisOption?"Logarithmic Amount (unit: BGP)":"Transaction Amount (unit: BGP)")},generateCustomTicks(e){const t=[],a=B.jkA(e),n=B.T9B(e);t.push(a);let r=a.getFullYear();while(r<=n.getFullYear()){const e=new Date(r,0,1),s=new Date(r,6,1);e>=a&&e<=n&&t.push(e),s>=a&&s<=n&&t.push(s),r++}return t[t.length-1].getTime()!==n.getTime()&&t.push(n),t}}};const hn=(0,o.A)(pn,[["render",mn],["__scopeId","data-v-2d154a88"]]);var gn=hn;const yn=e=>((0,r.Qi)("data-v-12f47b6c"),e=e(),(0,r.jt)(),e),vn={class:"average-day"},fn=yn((()=>(0,r.Lk)("h2",null,"Average Day Analysis",-1)));function bn(e,t,a,n,s,i){return(0,r.uX)(),(0,r.CE)("div",vn,[fn,(0,r.Lk)("p",null,"Average number of transactions per day: "+(0,nt.v_)(n.averageTransactions),1),(0,r.Lk)("p",null,"Average number of different subCategories per day: "+(0,nt.v_)(n.averageSubCategories),1),(0,r.Lk)("p",null,"Average Amount per Transaction: "+(0,nt.v_)(n.averageTransactionAmount.toFixed(2)),1),(0,r.Lk)("p",null,"Average Amount per Day: "+(0,nt.v_)(n.averageDailyAmount.toFixed(2)),1)])}var An={name:"AverageDay",props:{parsedData:{type:Array,required:!0}},setup(e){const t=(0,r.EW)((()=>{const t=new Map;return e.parsedData.forEach((e=>{const a=e["date"];t.has(a)||t.set(a,[]),t.get(a).push(e)})),t})),a=(0,r.EW)((()=>{const e=[];return t.value.forEach((t=>{const a=t.length,n=new Set(t.map((e=>e.subCategory))).size;e.push({transactionCount:a,subCategoryCount:n})})),e})),n=(0,r.EW)((()=>{const e=a.value.reduce(((e,t)=>e+t.transactionCount),0);return(e/a.value.length).toFixed(4)})),s=(0,r.EW)((()=>{const e=a.value.reduce(((e,t)=>e+t.subCategoryCount),0);return(e/a.value.length).toFixed(4)})),i=(0,r.EW)((()=>{const t=e.parsedData.reduce(((e,t)=>e+(t["debitAmount"]||0)+(t["creditAmount"]||0)),0);return t/e.parsedData.length})),l=(0,r.EW)((()=>{let e=0;return t.value.forEach((t=>{const a=t.reduce(((e,t)=>e+(t["debitAmount"]||0)+(t["creditAmount"]||0)),0);e+=a})),e/t.value.size}));return{averageTransactions:n,averageSubCategories:s,averageTransactionAmount:i,averageDailyAmount:l}}};const kn=(0,o.A)(An,[["render",bn],["__scopeId","data-v-12f47b6c"]]);var wn=kn,xn=a(8908),Dn=a(5998),Cn=a(6638),Sn=a(306),Fn=a(8205),qn=a(514),Ln=a(1361),Mn=a(8548),_n={name:"Page2",components:{ElButton:Be.S2,ElSwitch:At.qi,ElContainer:i.lX,ElMain:i.ZO,ElTree:xn.q,ElScrollbar:Dn.kA,TransactionSimilarity:St,KMeans:Bt,TopSimilarList:ia,AlgorithmProcess:Ba,CategoryDistribution:Ja,AmountDistribution:ln,TimeDistribution:gn,AverageDay:wn,ElAnchor:Cn.pq,ElAnchorLink:Cn.ZS,ElCol:Sn.uD,ElSelect:Fn.AV,ElOption:Fn.P9,ElRadioGroup:Kt.MQ,ElRadio:Kt.ll,ElDropdown:qn.dW,ElDropdownMenu:qn.Iy,ElDropdownItem:qn.c6,ElIcon:Ln.tk,ArrowDown:Mn.yd$},watch:{selectedMapping(){this.showMappingLegend=!0},selectedDropdown(){this.showMappingLegend=!1}},methods:{toggleTransactionDetail(){this.showTransactionDetail=!this.showTransactionDetail},openKMeansDrawer(){this.$nextTick((()=>{this.$refs.kmeansComponent?this.$refs.kmeansComponent.openDrawer():console.error("KMeans component is not loaded or ref is not set correctly.")}))},closeDetail(){this.showTransactionDetail=!1},handleDropdownCommand(e){this.selectedDropdown=e}},setup(){const e=(0,z.KR)(!1),t=(0,z.KR)(!1),a=(0,z.KR)("levenshtein");let n=(0,z.KR)([]),s=(0,z.KR)(null);const i=(0,z.KR)([]),l=(0,z.KR)([{id:1,label:"Transaction Category",children:[]}]),o={children:"children",label:"label"},c=(0,z.KR)(new Set),d=(0,z.KR)([]),u=(0,z.KR)(null),m=(0,z.KR)(null),p=(0,z.KR)("none"),h=(0,z.KR)(!1),g=(0,z.KR)(null),y=(0,z.KR)(!0),f=(0,z.KR)(!1),b=(0,z.KR)({date:"",category:"",subCategory:"",debitAmount:"",creditAmount:"",sequence:""}),A=(0,z.KR)({date:"",sequence:"",debitAmounts:[],creditAmounts:[]}),k=(0,z.KR)({}),w=(0,z.KR)({}),x=(0,z.KR)([]),D=(0,z.KR)({}),C=(0,z.KR)({}),S=(0,z.KR)("category"),F={levenshtein:'<strong>Levenshtein Distance</strong>: Measures how many single-character edits (<span class = "key-words">insertions</span>, <span class = "key-words">deletions</span>, or <span class = "key-words">substitutions</span>) are needed to change one string into another.',"damerau-levenshtein":'<strong>Damerau-Levenshtein Distance</strong>: Measures the number of single-character edits (<span class = "key-words">insertions</span>, <span class = "key-words">deletions</span>, <span class = "key-words">substitutions</span>, or <span class = "key-words">transpositions of two adjacent characters</span>) needed to change one string into another',hamming:'<strong>Hamming Distance</strong>: Counts the number of positions at which two strings of <span class = "key-words">equal length</span> have different characters.',"jaro-winkler":'<strong>Jaro-Winkler Distance</strong>: Measures the similarity between two strings based on the <span class = "key-words">number and order</span> of matching characters. <span class = "key-words">Common prefixes</span> increase the similarity score.'},q=(0,z.KR)(F[a.value]);(0,r.wB)(a,(e=>{q.value=F[e],A.value=null}));const L=async e=>{const t=[...d.value],a=await v();n.value=a.jsonData,s.value=a.worksheet;const r=Ie(n.value,s.value,e,c.value,p.value);i.value=r.parsedData,k.value=r.dailySequences,w.value=r.dailyAmounts,C.value=Object.fromEntries(Object.entries(r.yearPositions).sort(((e,t)=>t[0]-e[0]))),$(),u.value.setCheckedKeys(t)},M=()=>{if(b.value&&b.value.date&&b.value.sequence){const e=b.value.date,t=b.value.sequence;if(t){const n={date:e,sequence:t,debitAmounts:w.value[e].debitAmounts,creditAmounts:w.value[e].creditAmounts},r=Object.keys(k.value).filter((t=>t!==e)).map((e=>({date:e,sequence:k.value[e],debitAmounts:w.value[e].debitAmounts,creditAmounts:w.value[e].creditAmounts})));"category"===S.value?x.value=et(n,r,a.value):"amount"===S.value?x.value=tt(n,r):"combined"===S.value&&(x.value=at(n,r,a.value))}}else console.error("Selected Details do not have the expected structure:",b.value)};(0,r.wB)(S,(()=>{b.value&&b.value.date&&b.value.sequence&&M()})),(0,r.wB)(b,(()=>{M()}));const _=e=>{x.value=e};(0,r.wB)(x,(e=>{if(e&&w.value){const t={};e.forEach((e=>{w.value[e.date]&&(t[e.date]={debitAmounts:w.value[e.date].debitAmounts,creditAmounts:w.value[e.date].creditAmounts})})),D.value=t}}));const E=e=>{A.value=e},T={"Daily expenses and consumption":"Daily expenses & consumption","Financial management and transfers":"Financial management & transfers","Housing and facilities":"Housing & facilities","Income and investments":"Income & investments","Insurance and Health":"Insurance & Health"},$=()=>{const e=[...Array.from(new Set(n.value.map((e=>e.Category?e.Category.trim():"Null")).filter((e=>"Null"!==e)))).sort(((e,t)=>e.localeCompare(t)))];l.value[0].children=e.map((e=>({id:e,label:T[e]||e,children:n.value.filter((t=>t.Category===e)).map((e=>e.subCategory?e.subCategory.trim():"Null")).filter(((e,t,a)=>a.indexOf(e)===t)).map((t=>({id:`${e}-${t}`,label:t,color:xe[t]||"transparent"})))})))},O=(t,{checkedNodes:a,checkedKeys:r})=>{d.value=r;const i=new Set(a.filter((e=>null==e.children)).map((e=>e.label)));c.value=i,u.value.setCheckedKeys(d.value),Ie(n.value,s.value,e.value,c.value,p.value)},I=e=>{if(e.target.classList.contains("event-rect")){const t=e.target.__data__.date,a=e.target.__data__.category,n=e.target.__data__.subCategory,r=e.target.__data__.debitAmount,s=e.target.__data__.creditAmount,i=k.value[t];b.value={date:t,category:a,subCategory:n,debitAmount:r,creditAmount:s,sequence:i,debitAmounts:w.value[t].debitAmounts,creditAmounts:w.value[t].creditAmounts},f.value=!0}};(0,r.wB)(p,(t=>{L(e.value).then((()=>{u.value.setCheckedKeys(d.value),B.Ltv(".mapping-legend").selectAll("*").remove(),"height"===t?We(".mapping-legend"):"width"===t?He(".mapping-legend"):"area"===t&&je(".mapping-legend")})),y.value=!0})),(0,r.wB)(g,(()=>{y.value=!1})),(0,r.sV)((()=>{L(e.value).then((()=>{const t=l.value[0].children.flatMap((e=>e.children.map((e=>e.id)))),a=l.value[0].children.flatMap((e=>e.children.map((e=>e.label))));u.value.setCheckedKeys(t),c.value=new Set(a),d.value=t,u.value.setCheckedKeys(d.value);const r=Ie(n.value,s.value,e.value,c.value,p.value);k.value=r.dailySequences,C.value=r.yearPositions,"height"===p.value?We(".mapping-legend"):"width"===p.value?He(".mapping-legend"):"area"===p.value&&je(".mapping-legend")}))}));const W=(e,{node:t,data:a})=>e("span",[e("span",{style:{backgroundColor:a.color||"transparent",marginRight:"5px",width:"14px",height:"14px",display:"inline-block",borderRadius:"50%"}}),e("span",{class:"tree-node-text"},t.label)]);(0,r.wB)(e,(t=>{L(t).then((()=>{u.value.setCheckedKeys(d.value),Ie(n.value,s.value,e.value,c.value,p.value)}))})),(0,r.wB)(a,(()=>{f.value&&M()})),(0,r.wB)(t,(e=>{const t=document.documentElement;e?(t.style.setProperty("--text-color","#606266"),t.style.setProperty("--bg-color","#ffffff"),t.style.setProperty("--scrollbar-color","#CDCDCD"),t.style.setProperty("--scrollbar-hover-color","#C7C9CC"),t.style.setProperty("--month-header-color","#F5F7FA")):(t.style.setProperty("--text-color","#CFD3DC"),t.style.setProperty("--bg-color","#141414"),t.style.setProperty("--scrollbar-color","#A3A6AD"),t.style.setProperty("--scrollbar-hover-color","#E5EAF3"),t.style.setProperty("--month-header-color","#555555"))}));const H=()=>{const t=l.value[0].children.flatMap((e=>e.children.map((e=>e.id))));c.value=new Set(l.value[0].children.flatMap((e=>e.children.map((e=>e.label))))),u.value.setCheckedKeys(t),d.value=t,Ie(n.value,s.value,e.value,c.value,p.value)},j=()=>{c.value=new Set,u.value.setCheckedKeys([]),d.value=[],Ie(n.value,s.value,e.value,c.value,p.value)},K=e=>{e.preventDefault();const t=e.target,a=t.getAttribute("href");if(a&&m.value){const e=a.replace("#year-",""),t=C.value[e];void 0!==t&&m.value.scrollTo({top:t,behavior:"smooth"})}};return{jsonData:n,worksheet:s,parsedData:i,showAllDates:e,isDarkMode:t,selectedAlgorithm:a,selectedMapping:p,selectedOption:S,selectedCategories:c,updateTopSimilarSequences:M,selectAll:H,clearAll:j,legendData:l,defaultProps:o,handleCheck:O,legendTree:u,renderContent:W,dailySequences:k,fetchData:L,selectedDetails:b,showDetail:I,handleUpdateTopSimilarSequences:_,topSimilarSequences:x,yearPositions:C,containerRef:m,handleYearClick:K,selectedDescription:q,dailyAmounts:w,listAmounts:D,selectedSimilarDetails:A,handleSelectSimilarSequence:E,showTransactionDetail:h,selectedDropdown:g,showMappingLegend:y}}};const En=(0,o.A)(_n,[["render",X],["__scopeId","data-v-3cd2b8f4"]]);var Tn=En;const $n=e=>((0,r.Qi)("data-v-0343723c"),e=e(),(0,r.jt)(),e),On=$n((()=>(0,r.Lk)("h1",null,"color map design",-1))),In=$n((()=>(0,r.Lk)("div",{id:"colormap-container"},[(0,r.Lk)("canvas",{id:"colormap-canvas"})],-1))),Wn={id:"category-colors"};function Hn(e,t,a,n,s,i){const l=(0,r.g2)("el-header"),o=(0,r.g2)("el-main"),c=(0,r.g2)("el-container");return(0,r.uX)(),(0,r.Wv)(c,null,{default:(0,r.k6)((()=>[(0,r.bF)(l,null,{default:(0,r.k6)((()=>[On])),_:1}),(0,r.bF)(o,null,{default:(0,r.k6)((()=>[In,(0,r.Lk)("div",Wn,[(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.categoryColors,((e,t)=>((0,r.uX)(),(0,r.CE)("li",{key:t},[(0,r.Lk)("span",{style:(0,nt.Tr)({backgroundColor:e}),class:"color-box"},null,4),(0,r.eW)(" "+(0,nt.v_)(s.categories[t])+": "+(0,nt.v_)(e),1)])))),128))])])])),_:1})])),_:1})}function jn(e,t,a){return"#"+((1<<24)+(e<<16)+(t<<8)+a).toString(16).slice(1).toUpperCase()}function Kn(e,t,a){const n=new Image;n.src=e,n.crossOrigin="Anonymous",n.onload=()=>{const e=document.createElement("canvas"),r=e.getContext("2d");e.width=n.width,e.height=n.height,r.drawImage(n,0,0,n.width,n.height);const s=[],i=[],l=Math.floor(n.height/2);for(let a=0;a<t;a++){const e=Math.floor(a/t*n.width),o=r.getImageData(e,l,1,1).data,c=jn(o[0],o[1],o[2]);s.push(c),i.push({x:e,y:l})}a(s,i)},n.onerror=e=>{console.error("Error loading image:",e)}}var Rn={name:"Page3",components:{ElContainer:i.lX,ElHeader:i.bZ,ElMain:i.ZO},data(){return{categories:["Income and investments","Daily expenses and consumption","Housing and facilities","Insurance and Health","Financial management and transfers","Other miscellaneous"],categoryColors:[],colorPositions:[]}},mounted(){const e="/colormap_hsv_trimmed.png",t=this.categories.length;Kn(e,t,((t,a)=>{this.categoryColors=t,this.colorPositions=a,this.drawImageWithMarkers(e,a)}))},methods:{drawImageWithMarkers(e,t){const a=document.getElementById("colormap-canvas"),n=a.getContext("2d"),r=new Image;r.src=e,r.crossOrigin="Anonymous",r.onload=()=>{a.width=r.width,a.height=r.height,n.drawImage(r,0,0,r.width,r.height),n.fillStyle="white",t.forEach((e=>{n.beginPath(),n.arc(e.x,e.y,6,0,2*Math.PI),n.fill()}))}}}};const Vn=(0,o.A)(Rn,[["render",Hn],["__scopeId","data-v-0343723c"]]);var Xn=Vn;const Bn=e=>((0,r.Qi)("data-v-14c1f91e"),e=e(),(0,r.jt)(),e),zn={key:0,class:"transaction-detail"},Pn={class:"header"},Yn={key:0,class:"similar-sequences"},Nn=Bn((()=>(0,r.Lk)("h3",null,"Top 10 Similar Sequences",-1))),Un={class:"year-view"},Qn={class:"year-header"},Gn={class:"months"},Jn={class:"month-header"},Zn={class:"days"},er=Bn((()=>(0,r.Lk)("h2",null,"Timeline",-1)));function tr(e,t,a,n,s,i){const l=(0,r.g2)("el-button"),o=(0,r.g2)("el-button-group"),c=(0,r.g2)("el-calendar"),d=(0,r.g2)("el-tab-pane"),u=(0,r.g2)("el-tabs");return s.visible?((0,r.uX)(),(0,r.CE)("div",zn,[(0,r.Lk)("div",Pn,[(0,r.Lk)("p",null,(0,nt.v_)(s.details),1),(0,r.bF)(l,{onClick:i.close,class:"close-button"},{default:(0,r.k6)((()=>[(0,r.eW)("Close")])),_:1},8,["onClick"])]),(0,r.bF)(u,{type:"border-card",class:"custom-tabs"},{default:(0,r.k6)((()=>[(0,r.bF)(d,{label:"Month View"},{default:(0,r.k6)((()=>[(0,r.bF)(c,{ref:"calendar",modelValue:s.currentDate,"onUpdate:modelValue":t[4]||(t[4]=e=>s.currentDate=e),onInput:i.handleDateChange},{header:(0,r.k6)((({date:e})=>[(0,r.Lk)("span",null,(0,nt.v_)(e),1),(0,r.bF)(o,null,{default:(0,r.k6)((()=>[(0,r.bF)(l,{size:"small",onClick:t[0]||(t[0]=e=>i.selectDate("prev-year"))},{default:(0,r.k6)((()=>[(0,r.eW)("Previous Year")])),_:1}),(0,r.bF)(l,{size:"small",onClick:t[1]||(t[1]=e=>i.selectDate("prev-month"))},{default:(0,r.k6)((()=>[(0,r.eW)("Previous Month")])),_:1}),(0,r.bF)(l,{size:"small",onClick:i.goToCurrentDay},{default:(0,r.k6)((()=>[(0,r.eW)("Current Day")])),_:1},8,["onClick"]),(0,r.bF)(l,{size:"small",onClick:t[2]||(t[2]=e=>i.selectDate("next-month"))},{default:(0,r.k6)((()=>[(0,r.eW)("Next Month")])),_:1}),(0,r.bF)(l,{size:"small",onClick:t[3]||(t[3]=e=>i.selectDate("next-year"))},{default:(0,r.k6)((()=>[(0,r.eW)("Next Year")])),_:1})])),_:1})])),_:1},8,["modelValue","onInput"]),s.topSimilarSequences.length?((0,r.uX)(),(0,r.CE)("div",Yn,[Nn,(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.topSimilarSequences,((e,t)=>((0,r.uX)(),(0,r.CE)("li",{key:t},(0,nt.v_)(e.date)+": "+(0,nt.v_)(e.sequence)+" ("+(0,nt.v_)(e.similarity.toFixed(2))+"%) ",1)))),128))])])):(0,r.Q3)("",!0)])),_:1}),(0,r.bF)(d,{label:"Year View"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",Un,[(0,r.Lk)("div",Qn,(0,nt.v_)(s.currentYear),1),(0,r.Lk)("div",Gn,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.months,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{class:"month",key:t},[(0,r.Lk)("div",Jn,(0,nt.v_)(e.name),1),(0,r.Lk)("div",Zn,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.days,(e=>((0,r.uX)(),(0,r.CE)("div",{class:"day",key:e},(0,nt.v_)(e),1)))),128))])])))),128))])])])),_:1}),(0,r.bF)(d,{label:"Timeline"},{default:(0,r.k6)((()=>[er])),_:1})])),_:1})])):(0,r.Q3)("",!0)}var ar={data(){return{visible:!0,details:"Transaction Details",currentDate:new Date,currentYear:(new Date).getFullYear(),topSimilarSequences:[],months:[{name:"January",days:this.generateDays(31)},{name:"February",days:this.generateDays(28)},{name:"March",days:this.generateDays(31)},{name:"April",days:this.generateDays(30)},{name:"May",days:this.generateDays(31)},{name:"June",days:this.generateDays(30)},{name:"July",days:this.generateDays(31)},{name:"August",days:this.generateDays(31)},{name:"September",days:this.generateDays(30)},{name:"October",days:this.generateDays(31)},{name:"November",days:this.generateDays(30)},{name:"December",days:this.generateDays(31)}]}},methods:{close(){this.visible=!1},handleDateChange(e){this.currentDate=e},selectDate(e){const t=new Date(this.currentDate);"prev-year"===e?t.setFullYear(t.getFullYear()-1):"prev-month"===e?t.setMonth(t.getMonth()-1):"next-month"===e?t.setMonth(t.getMonth()+1):"next-year"===e&&t.setFullYear(t.getFullYear()+1),this.currentDate=t},goToCurrentDay(){this.currentDate=new Date},generateDays(e){return Array.from({length:e},((e,t)=>t+1))}}};const nr=(0,o.A)(ar,[["render",tr],["__scopeId","data-v-14c1f91e"]]);var rr=nr;const sr=[{path:"/page1",component:A},{path:"/page2",component:Tn},{path:"/page3",component:Xn},{path:"/page4",component:rr},{path:"/",redirect:"/page1"}],ir=(0,u.aE)({history:(0,u.Bt)(),routes:sr});var lr=ir,or=a(6795);a(4188);const cr=(0,n.Ef)(d);cr.use(lr),cr.use(or.A),cr.mount("#app"),(0,n.Ef)(d).use(lr).mount("#app")}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,n,r,s){if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],s=e[d][2];for(var l=!0,o=0;o<n.length;o++)(!1&s||i>=s)&&Object.keys(a.O).every((function(e){return a.O[e](n[o])}))?n.splice(o--,1):(l=!1,s<i&&(i=s));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,r,s]}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,s,i=n[0],l=n[1],o=n[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(o)var d=o(a)}for(t&&t(n);c<i.length;c++)s=i[c],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},n=self["webpackChunkmy_vue3_app"]=self["webpackChunkmy_vue3_app"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(9374)}));n=a.O(n)})();
//# sourceMappingURL=app.b1669ff4.js.map